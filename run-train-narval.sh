#!/bin/bash

#SBATCH --account=rrg-bengioy-ad
#SBATCH --cpus-per-task=4
#SBATCH --gres=gpu:a100:1
#SBATCH --mem=40G
#SBATCH --time=23:59:00
#SBATCH --output=./slurm_out/slot-attention-%j.out
#SBATCH --error=./slurm_err/slot-attention-%j.err

module load StdEnv/2020
module load coinmp
module load python/3.8
module load scipy-stack
module load httpproxy
source /home/aminm/mbd/bin/activate

export WANDB_API_KEY=1406ef3255ef2806f2ecc925a5e845e7164b5eef
wandb login

export LD_PRELOAD=/home/aminm/mechanism-based-disentanglement/disentanglement_by_mechanisms/hack.so
export WANDB_MODE=offline

# for runs more than a day, use: 1-11:59:00 (day-hour)
# resume from a mila cluster ckpt using a decoder, same slot init, etc., to train the decoder with much more compute. ALSO uses truncate bp
# python3 ../run.py mode=train model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.n_balls=2 model/optimizer=adamw model.optimizer.lr=0.0001 model/scheduler_config=reduce_on_plateau model.encoder.slot_size=64 model.encoder.resolution_dim=64 model.encoder.hid_dim=64 ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","same-init","dec","svd"] ckpt_path=null
# python3 ../run_training.py model=inertia_balls_saae_contrastive_recons_ckpt datamodule=inertia_balls datamodule.n_balls=3 model/optimizer=adamw model.optimizer.lr=0.0001 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval"] trainer.max_epochs=400
# python3 ../run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.n_balls=3 model/optimizer=adamw model.optimizer.lr=0.0001 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cvxpy"] trainer.max_epochs=600 ckpt_path=null

# python3 ../run.py mode=train model=inertia_balls_saae_contrastive_enc_only datamodule=inertia_balls model/optimizer=adamw model.optimizer.lr=0.0001 model/scheduler_config=polynomial model.encoder.slot_size=32 model.encoder.resolution_dim=64 model.encoder.hid_dim=64 ~callbacks.visualization_callback ckpt_path=null ~callbacks.early_stopping

# python3 ../run.py mode=train model=inertia_balls_slot_attention_ae datamodule=inertia_balls model/optimizer=adam model.optimizer.lr=0.00001 model.encoder.slot_size=32 model.encoder.resolution_dim=64 model.encoder.decoder_init_res_dim=4 model.encoder.hid_dim=64 model/scheduler_config=polynomial ckpt_path=null
# python3 run.py mode=train model=clevr_slot_attention_ae datamodule=clevr.yaml model/optimizer=adam model.optimizer.lr=0.001  model.encoder.resolution_dim=128 model.encoder.decoder_init_res_dim=8 model.encoder.hid_dim=128 # model/scheduler_config=polynomial datamodule.num_workers=0

# ablation same color
# python3 ../run_training.py model=inertia_balls_saae_contrastive_recons model.w_latent_loss=100. model.w_recons_loss=10.0 datamodule=inertia_balls datamodule.color_selection=same datamodule.n_balls=2 model/optimizer=adamw model.optimizer.lr=0.0001 ~model/scheduler_config model.encoder.slot_size=128 model.encoder.resolution_dim=64 model.encoder.hid_dim=128 ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","same_color","ablation"] ckpt_path=null

# ablation random color
# python3 ../run_training.py model=inertia_balls_saae_contrastive_recons model.w_latent_loss=100. model.w_recons_loss=10.0 datamodule=inertia_balls datamodule.color_selection=random datamodule.n_balls=2 model/optimizer=adamw model.optimizer.lr=0.0001 ~model/scheduler_config model.encoder.slot_size=128 model.encoder.resolution_dim=64 model.encoder.hid_dim=128 ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","random_color","ablation"] ckpt_path=null

# ----------------------------------------------------------------------------------------------------------------
# lin_sum_assignment as matching to speed up training enc-dec
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule.color_selection="cyclic_fixed" datamodule=inertia_balls datamodule.n_balls=2 model/optimizer=adamw model.optimizer.lr=0.0002 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","lin_sum","fixed_color"] ckpt_path=null trainer.max_epochs=700

# same color
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule.color_selection="same" datamodule=inertia_balls datamodule.n_balls=8 model/optimizer=adamw model.optimizer.lr=0.0001 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","lin_sum","same_color"] ckpt_path=null trainer.max_epochs=800

# resuming training with a ckpt
# resume from 2 balls ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.n_balls=2 model/optimizer=adamw model.optimizer.lr=0.00001 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","lin_sum","resumed"] trainer.max_epochs=800 ckpt_path="/home/aminm/scratch/logs/training/multiruns/SA_inertia_balls_contrastive_recons/2022-08-06_13-04-15/datamodule.n_balls\=2\,model.optimizer.lr\=0.0001/checkpoints/SA_inertia_balls_contrastive_recons-epoch\=199-train_loss\=0.47-Linear_Disentanglement\=0.73.ckpt"
# resume from 3 balls ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.n_balls=3 model/optimizer=adamw model.optimizer.lr=0.000005 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","lin_sum","resumed","fixed_color"] trainer.max_epochs=800 ckpt_path="/home/aminm/scratch/logs/training/multiruns/SA_inertia_balls_contrastive_recons_3/2022-08-13_14-32-53/datamodule.color_selection\=cyclic_fixed\,datamodule.n_balls\=3\,model.optimizer.lr\=0.0002\,trainer.max_epochs\=400/checkpoints/SA_inertia_balls_contrastive_recons_3-epoch\=175-train_loss\=1.04-Linear_Disentanglement\=0.63.ckpt"
# resume from 4 balls ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.n_balls=4 model/optimizer=adamw model.optimizer.lr=0.00001 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","lin_sum","resumed"] trainer.max_epochs=800 ckpt_path="/home/aminm/scratch/logs/training/multiruns/SA_inertia_balls_contrastive_recons/2022-08-06_13-04-15/datamodule.n_balls\=4\,model.optimizer.lr\=0.0001/checkpoints/SA_inertia_balls_contrastive_recons-epoch\=98-train_loss\=1.96-Linear_Disentanglement\=0.42.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.n_balls=4 model/optimizer=adamw model.optimizer.lr=0.0002 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","lin_sum","resumed"] trainer.max_epochs=800 ckpt_path="/home/aminm/scratch/logs/training/multiruns/SA_inertia_balls_contrastive_recons_4/2022-08-13_14-32-53/datamodule.color_selection\=cyclic_fixed\,datamodule.n_balls\=4\,model.optimizer.lr\=0.0002\,trainer.max_epochs\=400/checkpoints/SA_inertia_balls_contrastive_recons_4-epoch\=399-train_loss\=0.42-Linear_Disentanglement\=0.87.ckpt"
# resume from 5 balls ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.n_balls=5 model/optimizer=adamw model.optimizer.lr=0.00001 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","lin_sum","resumed"] trainer.max_epochs=800 ckpt_path="/home/aminm/scratch/logs/training/multiruns/SA_inertia_balls_contrastive_recons/2022-08-06_13-04-15/datamodule.n_balls\=5\,model.optimizer.lr\=0.0001/checkpoints/SA_inertia_balls_contrastive_recons-epoch\=99-train_loss\=2.37-Linear_Disentanglement\=0.35.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.n_balls=5 model/optimizer=adamw model.optimizer.lr=0.00004 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","lin_sum","resumed"] trainer.max_epochs=800 ckpt_path="/home/aminm/scratch/logs/training/multiruns/SA_inertia_balls_contrastive_recons_5/2022-08-13_14-32-53/datamodule.color_selection\=cyclic_fixed\,datamodule.n_balls\=5\,model.optimizer.lr\=0.0002\,trainer.max_epochs\=400/checkpoints/SA_inertia_balls_contrastive_recons_5-epoch\=359-train_loss\=2.19-Linear_Disentanglement\=0.20.ckpt"
# resume from 6 balls ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.n_balls=6 model/optimizer=adamw model.optimizer.lr=0.00001 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","lin_sum","resumed"] trainer.max_epochs=800 ckpt_path="/home/aminm/scratch/logs/training/multiruns/SA_inertia_balls_contrastive_recons/2022-08-06_13-04-15/datamodule.n_balls\=6\,model.optimizer.lr\=0.0001/checkpoints/SA_inertia_balls_contrastive_recons-epoch\=199-train_loss\=3.04-Linear_Disentanglement\=0.19.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.n_balls=6 model/optimizer=adamw model.optimizer.lr=0.00004 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","lin_sum","resumed"] trainer.max_epochs=800 ckpt_path="/home/aminm/scratch/logs/training/multiruns/SA_inertia_balls_contrastive_recons_6/2022-08-13_14-32-53/datamodule.color_selection\=cyclic_fixed\,datamodule.n_balls\=6\,model.optimizer.lr\=0.0002\,trainer.max_epochs\=400/checkpoints/SA_inertia_balls_contrastive_recons_6-epoch\=349-train_loss\=1.47-Linear_Disentanglement\=0.63.ckpt"
# resume from 7 balls ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.n_balls=7 model/optimizer=adamw model.optimizer.lr=0.00004 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","lin_sum","resumed"] trainer.max_epochs=800 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_7/2022-08-14_02-40-33/checkpoints/SA_inertia_balls_contrastive_recons_7-epoch\=302-train_loss\=2.05-Linear_Disentanglement\=0.15.ckpt"
# resume from 8 balls ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.n_balls=8 model/optimizer=adamw model.optimizer.lr=0.0002 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","lin_sum","resumed"] trainer.max_epochs=800 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_8/2022-08-14_02-50-39/checkpoints/SA_inertia_balls_contrastive_recons_8-epoch\=355-train_loss\=2.11-Linear_Disentanglement\=0.12.ckpt"

# ----------------------------------------------------------------------------------------------------------------
# baseline (vanilla slot attention)
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule.color_selection="cyclic_fixed" datamodule=inertia_balls datamodule.n_balls=2 model.optimizer.lr=0.0002 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","fixed_color"] ckpt_path=null trainer.max_epochs=800
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule=inertia_balls datamodule.n_balls=2 model.optimizer.lr=0.0002 ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","same"] ckpt_path=null trainer.max_epochs=800
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=3 model.optimizer.lr=0.0002 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","same"] ckpt_path=null trainer.max_epochs=800
# ------------------------------------------
# sweep August 29. For 3 balls trained for 24h, sweep over the following
# learning_rate=2e-5,2e-4, wait_steps=0,5000, linear_steps=1,5000, slot_size=hid_dim=64,128, w_latent_loss=10.0,100.0, w_recons_loss=1.0,10.0
# model=inertia_balls_saae_contrastive_recons, datamodule=inertia_balls, datamodule/dataset=position_offset_only, datamodule.color_selection="same", model.z_dim=2, datamodule.n_balls=3
# python3 run_training.py model=inertia_balls_saae_contrastive_recons model.z_dim=2 datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=3 model/optimizer=adamw model.optimizer.lr=0.0002 model.wait_steps=0 model.linear_steps=1 model.encoder.slot_size=128 model.w_latent_loss=10.0 model.w_recons_loss=1.0 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","hp_search_same","same"] ckpt_path=null trainer.max_epochs=700

# ------------------------------------------
# September. for 2-4 balls, pick a fully trained vanilla slot attention weights, and train our latent projection on top of it, i.e. the
# encoder should be loaded from a ckpt and then frozen. Or it can be finetuned. Note that ckpt paths are different for different #balls

# 2 balls, constrained_lp or linear_sum_assignemnt, frozen or finetuned
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=2 model.z_dim=2 model.latent_matching="constrained_lp" model.encoder.num_slots=3 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=True ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","constrained_lp","frozen_enc_dec","same"] ckpt_path=null trainer.max_epochs=700 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_same/2022-09-06_18-04-21/checkpoints/slot_attention_inertia_balls_autoencoder_2_same-epoch\=783-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=2 model.z_dim=2 model.latent_matching="constrained_lp" model.encoder.num_slots=3 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","constrained_lp","retrain_enc_dec","same"] ckpt_path=null trainer.max_epochs=700 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_same/2022-09-06_18-04-21/checkpoints/slot_attention_inertia_balls_autoencoder_2_same-epoch\=783-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=2 model.z_dim=2 model.latent_matching="lin_sum_assignment" model.encoder.num_slots=3 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=True ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","frozen_enc_dec","same","lin_sum_assignment"] ckpt_path=null trainer.max_epochs=700 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_same/2022-09-06_18-04-21/checkpoints/slot_attention_inertia_balls_autoencoder_2_same-epoch\=783-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=2 model.z_dim=2 model.latent_matching="lin_sum_assignment" model.encoder.num_slots=3 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","retrain_enc_dec","same","lin_sum_assignment"] ckpt_path=null trainer.max_epochs=700 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_same/2022-09-06_18-04-21/checkpoints/slot_attention_inertia_balls_autoencoder_2_same-epoch\=783-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"


# 3 balls, constrained_lp or linear_sum_assignemnt, frozen or finetuned
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=3 model.z_dim=2 model.latent_matching="constrained_lp" model.encoder.num_slots=5 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=True ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","constrained_lp","frozen_enc_dec","same"] ckpt_path=null trainer.max_epochs=700 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_3_same/2022-09-02_00-36-20/checkpoints/slot_attention_inertia_balls_autoencoder_3_same-epoch\=399-train_ARI\=0.93-Linear_Disentanglement_regression\=0.23-Permutation_Disentanglement_regression\=0.33.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=3 model.z_dim=2 model.latent_matching="constrained_lp" model.encoder.num_slots=5 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","constrained_lp","retrain_enc_dec","same"] ckpt_path=null trainer.max_epochs=700 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_3_same/2022-09-02_00-36-20/checkpoints/slot_attention_inertia_balls_autoencoder_3_same-epoch\=399-train_ARI\=0.93-Linear_Disentanglement_regression\=0.23-Permutation_Disentanglement_regression\=0.33.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=3 model.z_dim=2 model.latent_matching="lin_sum_assignment" model.encoder.num_slots=5 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=True ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","frozen_enc_dec","same"] ckpt_path=null trainer.max_epochs=700 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_3_same/2022-09-02_00-36-20/checkpoints/slot_attention_inertia_balls_autoencoder_3_same-epoch\=399-train_ARI\=0.93-Linear_Disentanglement_regression\=0.23-Permutation_Disentanglement_regression\=0.33.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=3 model.z_dim=2 model.latent_matching="lin_sum_assignment" model.encoder.num_slots=5 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","retrain_enc_dec","same"] ckpt_path=null trainer.max_epochs=700 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_3_same/2022-09-02_00-36-20/checkpoints/slot_attention_inertia_balls_autoencoder_3_same-epoch\=399-train_ARI\=0.93-Linear_Disentanglement_regression\=0.23-Permutation_Disentanglement_regression\=0.33.ckpt"
# continuing from a ckpt with frozen enc and constrained lp
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=3 model.z_dim=2 model.latent_matching="constrained_lp" model.encoder.num_slots=5 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=True ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","constrained_lp","frozen_enc_dec","same"] trainer.max_epochs=700 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_3_same/2022-09-05_11-31-19/checkpoints/SA_inertia_balls_contrastive_recons_3_same-epoch\=15-train_loss\=0.01-Linear_Disentanglement\=0.66-Permutation_Disentanglement\=0.81.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=3 model.z_dim=2 model.latent_matching="constrained_lp" model.encoder.num_slots=5 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","constrained_lp","retrain_enc_dec","same"] trainer.max_epochs=700 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_3_same/2022-09-05_11-31-19/checkpoints/SA_inertia_balls_contrastive_recons_3_same-epoch\=15-train_loss\=0.01-Linear_Disentanglement\=0.66-Permutation_Disentanglement\=0.81.ckpt"


# 4 balls, constrained_lp or linear_sum_assignemnt, frozen or finetuned
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=4 model.z_dim=2 model.latent_matching="constrained_lp" model.encoder.num_slots=7 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=True model.additional_logger.logging_interval=100 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","constrained_lp","frozen_enc_dec","same"] ckpt_path=null trainer.max_epochs=700 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/multiruns/slot_attention_inertia_balls_autoencoder_4_same/2022-09-04_02-38-18/callbacks\=vanilla_slot_attention\,datamodule.color_selection\=same\,datamodule.n_balls\=4\,datamodule/dataset\=position_offset_only\,model.optimizer.lr\=0.0002\,trainer.max_epochs\=800/checkpoints/slot_attention_inertia_balls_autoencoder_4_same-epoch\=411-train_ARI\=0.90-Linear_Disentanglement_regression\=0.17-Permutation_Disentanglement_regression\=0.25.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=4 model.z_dim=2 model.latent_matching="constrained_lp" model.encoder.num_slots=7 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False model.additional_logger.logging_interval=100 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","constrained_lp","retrain_enc_dec","same"] ckpt_path=null trainer.max_epochs=700 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/multiruns/slot_attention_inertia_balls_autoencoder_4_same/2022-09-04_02-38-18/callbacks\=vanilla_slot_attention\,datamodule.color_selection\=same\,datamodule.n_balls\=4\,datamodule/dataset\=position_offset_only\,model.optimizer.lr\=0.0002\,trainer.max_epochs\=800/checkpoints/slot_attention_inertia_balls_autoencoder_4_same-epoch\=411-train_ARI\=0.90-Linear_Disentanglement_regression\=0.17-Permutation_Disentanglement_regression\=0.25.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=4 model.z_dim=2 model.latent_matching="lin_sum_assignment" model.encoder.num_slots=7 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=True ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","frozen_enc_dec","same"] ckpt_path=null trainer.max_epochs=700 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/multiruns/slot_attention_inertia_balls_autoencoder_4_same/2022-09-04_02-38-18/callbacks\=vanilla_slot_attention\,datamodule.color_selection\=same\,datamodule.n_balls\=4\,datamodule/dataset\=position_offset_only\,model.optimizer.lr\=0.0002\,trainer.max_epochs\=800/checkpoints/slot_attention_inertia_balls_autoencoder_4_same-epoch\=411-train_ARI\=0.90-Linear_Disentanglement_regression\=0.17-Permutation_Disentanglement_regression\=0.25.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=4 model.z_dim=2 model.latent_matching="lin_sum_assignment" model.encoder.num_slots=7 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","retrain_enc_dec","same"] ckpt_path=null trainer.max_epochs=700 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/multiruns/slot_attention_inertia_balls_autoencoder_4_same/2022-09-04_02-38-18/callbacks\=vanilla_slot_attention\,datamodule.color_selection\=same\,datamodule.n_balls\=4\,datamodule/dataset\=position_offset_only\,model.optimizer.lr\=0.0002\,trainer.max_epochs\=800/checkpoints/slot_attention_inertia_balls_autoencoder_4_same-epoch\=411-train_ARI\=0.90-Linear_Disentanglement_regression\=0.17-Permutation_Disentanglement_regression\=0.25.ckpt"
# continuing from a ckpt with frozen (or not) enc and constrained lp
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=4 model.z_dim=2 model.latent_matching="constrained_lp" model.encoder.num_slots=6 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=True model.additional_logger.logging_interval=100 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","constrained_lp","frozen_enc_dec","same","resumed"] trainer.max_epochs=700 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_4_same/2022-09-06_13-32-22/checkpoints/SA_inertia_balls_contrastive_recons_4_same-epoch\=27-train_loss\=0.00-Linear_Disentanglement\=0.28-Permutation_Disentanglement\=0.52.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only datamodule.color_selection="same" datamodule.n_balls=4 model.z_dim=2 model.latent_matching="constrained_lp" model.encoder.num_slots=6 model.encoder.slot_size=128 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False model.additional_logger.logging_interval=100 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","constrained_lp","retrain_enc_dec","same","resumed"] trainer.max_epochs=700 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_4_same/2022-09-06_13-32-22/checkpoints/SA_inertia_balls_contrastive_recons_4_same-epoch\=27-train_loss\=0.00-Linear_Disentanglement\=0.28-Permutation_Disentanglement\=0.52.ckpt"
# ------------------------------------------------------------------------------------------------------------------------------
# Sept 6th; experiments exploring the possibility of disentangling colour when balls' positions aren't changed
# and we only have colour offsets as the mechanisms. We could use vanilla slot attention ckpts or train
# everything from scratch. Below we explore training from scratch

# 2 balls, colours and positions at time t are not the same across all samples, positions do not change from t->t+1 but colours do.
# training a vanilla slot attention to get a good encoder decoder for such DGP
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=inertia_balls datamodule/dataset=colour_offset_only datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.encoder.num_slots=3  model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","colour_disentanglement"] ckpt_path=null trainer.max_epochs=800
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=inertia_balls datamodule/dataset=colour_offset_only datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.encoder.num_slots=3  model/optimizer=adamw model.optimizer.lr=0.00002 model.encoder.slot_size=64 callbacks=default ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","colour_disentanglement"] trainer.max_epochs=1000 ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-10_17-48-11/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=150-train_ARI\=0.00-Linear_Disentanglement_regression\=0.01-Permutation_Disentanglement_regression\=0.08.ckpt"

# 2 balls, constrained_lp or linear_sum_assignment
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=colour_offset_only datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.z_dim=1 model.latent_matching="lin_sum_assignment" model.pair_recons=True model.encoder.num_slots=3 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","colour-disentangelement","cyclic_fixed","lin_sum_assignment"] trainer.max_epochs=700 ckpt_path=null
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=colour_offset_only datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.z_dim=1 model.latent_matching="constrained_lp" model.pair_recons=True model.encoder.num_slots=3 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","colour-disentangelement","cyclic_fixed","constrained_lp"] ckpt_path=null trainer.max_epochs=700
# training lin_sum_assignment from a lin_sum_assignment ckpt with frozen or finetuned encoder. loading the full state of training
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=colour_offset_only datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.z_dim=1 model.latent_matching="lin_sum_assignment" model.pair_recons=True model.encoder.num_slots=3 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","colour-disentangelement","cyclic_fixed","lin_sum_assignment","retrain_enc_dec"] trainer.max_epochs=700 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_1_n_balls_2_cyclic_fixed_lin_sum_assignment/2022-09-09_19-41-49/checkpoints/SA_inertia_balls_contrastive_recons_zdim_1_n_balls_2_cyclic_fixed_lin_sum_assignment-epoch\=299-train_loss\=0.10-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.04.ckpt"
# training lin_sum_assignment from a lin_sum_assignment ckpt with a finetuned encoder. loading only the state of the vanilla SA
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=colour_offset_only datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.z_dim=1 model.latent_matching="lin_sum_assignment" model.pair_recons=True model.encoder.num_slots=3 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","colour-disentangelement","cyclic_fixed","lin_sum_assignment","retrain_enc_dec"] trainer.max_epochs=700 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-10_17-48-11/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=150-train_ARI\=0.00-Linear_Disentanglement_regression\=0.01-Permutation_Disentanglement_regression\=0.08.ckpt" ckpt_path=null
# training constrained_lp from a lin_sum_assignment ckpt with frozen or finetuned encoder. loading the full state of training
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=colour_offset_only datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.z_dim=1 model.latent_matching="constrained_lp" model.pair_recons=True model.encoder.num_slots=3 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=True model.additional_logger.logging_interval=100 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","colour-disentangelement","cyclic_fixed","constrained_lp","frozen_enc_dec"] trainer.max_epochs=700 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_1_2_cyclic_fixed/2022-09-08_00-29-15/checkpoints/SA_inertia_balls_contrastive_recons_zdim_1_2_cyclic_fixed-epoch\=299-train_loss\=0.24-Linear_Disentanglement\=0.01-Permutation_Disentanglement\=0.06.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=colour_offset_only datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.z_dim=1 model.latent_matching="constrained_lp" model.pair_recons=True model.encoder.num_slots=3 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False model.additional_logger.logging_interval=100 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","colour-disentangelement","cyclic_fixed","constrained_lp","retrain_enc_dec"] trainer.max_epochs=700 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_1_2_cyclic_fixed/2022-09-08_00-29-15/checkpoints/SA_inertia_balls_contrastive_recons_zdim_1_2_cyclic_fixed-epoch\=299-train_loss\=0.24-Linear_Disentanglement\=0.01-Permutation_Disentanglement\=0.06.ckpt"


# ------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------

# Sept 11th; experiments with sparse known/unknown changes with either position or colour (but not both)

# ---------------------- position, unknown

# 2 balls, position, sparsity=1, lin_sum_assignment
# from scratch (constrained lp infeasible)
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.latent_matching="lin_sum_assignment" model/optimizer=adamw model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","different","position_disentanglement","lin_sum_assignment","sparse","unknown"] trainer.max_epochs=600 ckpt_path=null
# from a ckpt (has to have 128 dimensional slots). no wait steps required. note that only the encoder state dict should be loaded (so ckpt_path is null)
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.latent_matching="lin_sum_assignment" model/optimizer=adamw model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.encoder.slot_size=128 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","different","position_disentanglement","lin_sum_assignment","sparse","unknown","resume_from_ckpt"] trainer.max_epochs=600 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/multiruns/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-08-18_22-48-22/callbacks\=vanilla_slot_attention\,datamodule.color_selection\=cyclic_fixed\,datamodule.n_balls\=2\,model.optimizer.lr\=0.0002\,trainer.max_epochs\=800/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=214-train_loss\=0.00-Linear_Disentanglement_regression\=0.38-Permutation_Disentanglement_regression\=0.49.ckpt"
# constrained lp, the rest is same as above
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.latent_matching="constrained_lp" model/optimizer=adamw model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.encoder.slot_size=128 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","different","position_disentanglement","constrained_lp","sparse","unknown","resume_from_ckpt"] trainer.max_epochs=600 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/multiruns/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-08-18_22-48-22/callbacks\=vanilla_slot_attention\,datamodule.color_selection\=cyclic_fixed\,datamodule.n_balls\=2\,model.optimizer.lr\=0.0002\,trainer.max_epochs\=800/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=214-train_loss\=0.00-Linear_Disentanglement_regression\=0.38-Permutation_Disentanglement_regression\=0.49.ckpt"

# 3 balls, position, sparsity=1, lin_sum_assignment
# from scratch (constrained lp infeasible)
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=3 model.encoder.num_slots=4 datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.latent_matching="lin_sum_assignment" model/optimizer=adamw model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","different","position_disentanglement","lin_sum_assignment","sparse","unknown"] trainer.max_epochs=600 ckpt_path=null
# from a ckpt (has to have 128 dimensional slots). no wait steps required. note in this case we're loading a full ckpt so it's different than loading the state dict of VSA.
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=3 model.encoder.num_slots=4 datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.latent_matching="lin_sum_assignment" model/optimizer=adamw model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.encoder.slot_size=128 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","different","position_disentanglement","lin_sum_assignment","sparse","unknown","resume_from_ckpt"] trainer.max_epochs=600 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_3/2022-08-13_20-49-04/checkpoints/SA_inertia_balls_contrastive_recons_3-epoch\=365-train_loss\=0.87-Linear_Disentanglement\=0.62.ckpt"
# constrained lp, the rest is same as above
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=3 model.encoder.num_slots=4 datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.latent_matching="constrained_lp" model/optimizer=adamw model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.encoder.slot_size=128 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","different","position_disentanglement","constrained_lp","sparse","unknown","resume_from_ckpt"] trainer.max_epochs=600 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_3/2022-08-13_20-49-04/checkpoints/SA_inertia_balls_contrastive_recons_3-epoch\=365-train_loss\=0.87-Linear_Disentanglement\=0.62.ckpt"

# ---------------------- position, known

# 2 balls, position, sparsity=1, lin_sum_assignment
# from scratch (constrained lp infeasible)
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 datamodule.known_mechanism=True model.latent_matching="lin_sum_assignment" model/optimizer=adamw model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","different","position_disentanglement","lin_sum_assignment","sparse","known"] trainer.max_epochs=600 ckpt_path=null
# from a ckpt (has to have 128 dimensional slots). no wait steps required. note that only the encoder state dict should be loaded (so ckpt_path is null)
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 datamodule.known_mechanism=True model.latent_matching="lin_sum_assignment" model/optimizer=adamw model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.encoder.slot_size=128 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","different","position_disentanglement","lin_sum_assignment","sparse","known","resume_from_ckpt"] trainer.max_epochs=600 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/multiruns/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-08-18_22-48-22/callbacks\=vanilla_slot_attention\,datamodule.color_selection\=cyclic_fixed\,datamodule.n_balls\=2\,model.optimizer.lr\=0.0002\,trainer.max_epochs\=800/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=214-train_loss\=0.00-Linear_Disentanglement_regression\=0.38-Permutation_Disentanglement_regression\=0.49.ckpt"
# constrained lp, the rest is same as above
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 datamodule.known_mechanism=True model.latent_matching="constrained_lp" model/optimizer=adamw model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.encoder.slot_size=128 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","different","position_disentanglement","constrained_lp","sparse","known","resume_from_ckpt"] trainer.max_epochs=600 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/multiruns/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-08-18_22-48-22/callbacks\=vanilla_slot_attention\,datamodule.color_selection\=cyclic_fixed\,datamodule.n_balls\=2\,model.optimizer.lr\=0.0002\,trainer.max_epochs\=800/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=214-train_loss\=0.00-Linear_Disentanglement_regression\=0.38-Permutation_Disentanglement_regression\=0.49.ckpt"

# 3 balls, position, sparsity=1, lin_sum_assignment
# from scratch (constrained lp infeasible)
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=3 model.encoder.num_slots=4 datamodule.sparsity_degree=1 datamodule.known_mechanism=True model.latent_matching="lin_sum_assignment" model/optimizer=adamw model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","different","position_disentanglement","lin_sum_assignment","sparse","known"] trainer.max_epochs=600 ckpt_path=null
# from a ckpt (has to have 128 dimensional slots). no wait steps required. note in this case we're loading a full ckpt so it's different than loading the state dict of VSA.
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=3 model.encoder.num_slots=4 datamodule.sparsity_degree=1 datamodule.known_mechanism=True model.latent_matching="lin_sum_assignment" model/optimizer=adamw model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.encoder.slot_size=128 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","different","position_disentanglement","lin_sum_assignment","sparse","known","resume_from_ckpt"] trainer.max_epochs=600 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_3/2022-08-13_20-49-04/checkpoints/SA_inertia_balls_contrastive_recons_3-epoch\=365-train_loss\=0.87-Linear_Disentanglement\=0.62.ckpt"
# constrained lp, the rest is same as above
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=3 model.encoder.num_slots=4 datamodule.sparsity_degree=1 datamodule.known_mechanism=True model.latent_matching="constrained_lp" model/optimizer=adamw model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.encoder.slot_size=128 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","different","position_disentanglement","constrained_lp","sparse","known","resume_from_ckpt"] trainer.max_epochs=600 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_3/2022-08-13_20-49-04/checkpoints/SA_inertia_balls_contrastive_recons_3-epoch\=365-train_loss\=0.87-Linear_Disentanglement\=0.62.ckpt"





# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=colour_offset_only model.z_dim=1 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.latent_matching="lin_sum_assignment" model.pair_recons=True model/optimizer=adamw model.optimizer.lr=0.00002 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model.encoder_freeze=False ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","colour_disentanglement","lin_sum_assignment","sparse"] trainer.max_epochs=1000 ckpt_path=null

# # 3 balls
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=3 model.encoder.num_slots=4 datamodule.sparsity_degree=2 datamodule.known_mechanism=True model.latent_matching="lin_sum_assignment" model/optimizer=adamw model.optimizer.lr=0.00002 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model.encoder_freeze=False model.additional_logger.logging_interval=50 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cyclic_fixed","position_disentanglement","lin_sum_assignment","sparse"] trainer.max_epochs=1000 ckpt_path=null

# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.num_samples.train=100 datamodule.num_samples.valid=100 datamodule.num_samples.test=100 datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 datamodule.known_mechanism=True model.latent_matching="lin_sum_assignment" model/optimizer=adamw model.optimizer.lr=0.00002 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model.encoder_freeze=False model.additional_logger.logging_interval=10 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cyclic_fixed","position_disentanglement","lin_sum_assignment","sparse"] trainer.max_epochs=1000 ckpt_path=null
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.num_samples.train=100 datamodule.num_samples.valid=100 datamodule.num_samples.test=100 datamodule/dataset=position_offset_only model.z_dim=2 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 datamodule.known_mechanism=True model.latent_matching="constrained_lp" model/optimizer=adamw model.optimizer.lr=0.00002 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model.encoder_freeze=False model.additional_logger.logging_interval=10 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cyclic_fixed","position_disentanglement","constrained_lp","sparse"] trainer.max_epochs=1000 ckpt_path=null

# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.num_samples.train=100 datamodule.num_samples.valid=100 datamodule.num_samples.test=100 datamodule/dataset=colour_offset_only model.z_dim=1 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 datamodule.known_mechanism=True model.pair_recons=True model.latent_matching="lin_sum_assignment" model/optimizer=adamw model.optimizer.lr=0.00002 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model.encoder_freeze=False model.additional_logger.logging_interval=10 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cyclic_fixed","position_disentanglement","lin_sum_assignment","sparse"] trainer.max_epochs=1000 ckpt_path=null
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule.num_samples.train=100 datamodule.num_samples.valid=100 datamodule.num_samples.test=100 datamodule/dataset=colour_offset_only model.z_dim=1 datamodule.color_selection="cyclic_fixed" datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 datamodule.known_mechanism=True model.pair_recons=True model.latent_matching="constrained_lp" model/optimizer=adamw model.optimizer.lr=0.00002 model.w_recons_loss=100.0 model.wait_steps=10000 model.linear_steps=10000 model.encoder.slot_size=64 model.encoder_freeze=False model.additional_logger.logging_interval=10 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cyclic_fixed","colour_disentanglement","constrained_lp","sparse"] trainer.max_epochs=1000 ckpt_path=null

# ------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------

# Sept 13th; experiments with sparse known/unknown changes with all properties at the same time, training vanilla slot attention

# training vanilla slot attention with 2-4 balls where between t,t+1, only one property (out of 4) of only one ball changes.
# checkpointing can be based on ARI or train loss

# 2 balls
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 callbacks=vanilla_slot_attention ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","all_properties"] ckpt_path=null trainer.max_epochs=700
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","all_properties"] ckpt_path=null trainer.max_epochs=700
# continuing the training from a ckpt
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.sparsity_degree=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","all_properties","resume"] trainer.max_epochs=1800 ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"

# 3 balls
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.n_balls=3 model.encoder.num_slots=4 datamodule.sparsity_degree=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 callbacks=vanilla_slot_attention ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","all_properties"] ckpt_path=null trainer.max_epochs=700
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.n_balls=3 model.encoder.num_slots=4 datamodule.sparsity_degree=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","all_properties"] ckpt_path=null trainer.max_epochs=700
# continuing the training from a ckpt
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.n_balls=3 model.encoder.num_slots=4 datamodule.sparsity_degree=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","all_properties","resume"] trainer.max_epochs=1800 ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_3_cyclic_fixed/2022-09-13_22-33-09/checkpoints/slot_attention_inertia_balls_autoencoder_3_cyclic_fixed-epoch\=693-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"

# 4 balls
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.n_balls=4 model.encoder.num_slots=5 datamodule.sparsity_degree=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 callbacks=vanilla_slot_attention ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","all_properties"] ckpt_path=null trainer.max_epochs=700
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.n_balls=4 model.encoder.num_slots=5 datamodule.sparsity_degree=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","all_properties"] ckpt_path=null trainer.max_epochs=700
# continuing the training from a ckpt
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.n_balls=4 model.encoder.num_slots=5 datamodule.sparsity_degree=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","vanilla_SA","all_properties","resume"] trainer.max_epochs=1800 ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_4_cyclic_fixed/2022-09-13_22-37-43/checkpoints/slot_attention_inertia_balls_autoencoder_4_cyclic_fixed-epoch\=699-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"

# ------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------

# Sept 14th; experiments with sparse known/unknown changes with all properties at the same time, training the latent projection based on vanilla slot attention
# ckpts. The encoder decoder can either be frozen or not.

# 2 balls
# frozen enc, datamodule.dataset.z_dim=4, model.z_dim=4, model.disentangle_z_dim=2,3,4
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=4 datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.z_dim=4 model.disentangle_z_dim=4 model.latent_matching="argmin" model.double_matching=False model.use_all_balls_mcc=True model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=True callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","frozen"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2
# finetuned enc-dec, datamodule.dataset.z_dim=4, model.z_dim=4, model.disentangle_z_dim=2,3,4
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=4 datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.z_dim=4 model.disentangle_z_dim=4 model.latent_matching="argmin" model.double_matching=False model.use_all_balls_mcc=True model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","finetuned"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# frozen enc, datamodule.dataset.z_dim=3, model.z_dim=3, model.disentangle_z_dim=2,3
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=3 datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.z_dim=3 model.disentangle_z_dim=3 model.latent_matching="argmin" model.double_matching=False model.use_all_balls_mcc=True model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=True callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","frozen"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2
# finetuned enc-dec, datamodule.dataset.z_dim=3, model.z_dim=3, model.disentangle_z_dim=2,3
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=3 datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.z_dim=3 model.disentangle_z_dim=3 model.latent_matching="argmin" model.double_matching=False model.use_all_balls_mcc=True model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","finetuned"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# frozen enc, datamodule.dataset.z_dim=2, model.z_dim=2, model.disentangle_z_dim=2
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=2 datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.z_dim=2 model.disentangle_z_dim=2 model.latent_matching="argmin" model.double_matching=False model.use_all_balls_mcc=True model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=True callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","frozen"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2
# finetuned enc-dec, datamodule.dataset.z_dim=3, model.z_dim=2, model.disentangle_z_dim=2
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=2 datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.z_dim=2 model.disentangle_z_dim=2 model.latent_matching="argmin" model.double_matching=False model.use_all_balls_mcc=True model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","finetuned"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# Sept 18th; debugging with known action, no matching, unknown mechanism

# 2 balls
# frozen enc, datamodule.dataset.z_dim=2, model.z_dim=2, model.disentangle_z_dim=2
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=2 datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.z_dim=2 model.disentangle_z_dim=2 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.use_all_balls_mcc=False model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=True callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","frozen"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2
# finetuned enc, datamodule.dataset.z_dim=2, model.z_dim=2, model.disentangle_z_dim=2
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=2 datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.z_dim=2 model.disentangle_z_dim=2 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.use_all_balls_mcc=False model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","finetuned"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# frozen enc, datamodule.dataset.z_dim=3, model.z_dim=3, model.disentangle_z_dim=3
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","c"] datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.z_dim=3 model.disentangle_z_dim=3 datamodule.dataset.output_sparse_offsets=True datamodule.dataset.injective=False datamodule.dataset.same_color=False model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.use_all_balls_mcc=False model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=True callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","frozen"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2
# finetuned enc, datamodule.dataset.z_dim=3, model.z_dim=3, model.disentangle_z_dim=3
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=3 datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.z_dim=3 model.disentangle_z_dim=3 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.use_all_balls_mcc=False model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","finetuned"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# frozen enc, datamodule.dataset.z_dim=4, model.z_dim=4, model.disentangle_z_dim=4
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=4 datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.z_dim=4 model.disentangle_z_dim=4 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.use_all_balls_mcc=False model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=True callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","frozen"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2
# finetuned enc, datamodule.dataset.z_dim=4, model.z_dim=4, model.disentangle_z_dim=4
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=4 datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.z_dim=4 model.disentangle_z_dim=4 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.use_all_balls_mcc=False model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","finetuned"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=2 datamodule.dataset.properties_list=["x","s"] model.z_dim=2 model.disentangle_z_dim=2 datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.use_all_balls_mcc=False model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=True callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","frozen"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=1 datamodule.dataset.properties_list=["s"] model.z_dim=1 model.disentangle_z_dim=1 datamodule.dataset.signed=False datamodule.n_balls=2 model.encoder.num_slots=3 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.use_all_balls_mcc=False model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 datamodule.known_mechanism=False model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder.slot_size=64 model.encoder_freeze=True callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","all_properties","resume","frozen"] trainer.max_epochs=400 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt" datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# ------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------
# ------------------------------------------------------------------------------------------------------------------------------

# Sept 14th; experiments with sparse known/unknown changes with x,y with a cnn

# injective, different color, 1-4 balls
# python3 run_training.py model=inertia_balls_cnn_encoder datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=2 datamodule.dataset.properties_list=["x","y"] model.z_dim=2 model.disentangle_z_dim=2 datamodule.dataset.signed=False datamodule.n_balls=1 datamodule.dataset.output_sparse_offsets=False datamodule.dataset.injective=True datamodule.dataset.same_color=False model.known_mechanism=False datamodule.sparsity_degree=1 datamodule.known_mechanism=False model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cnn","injective","different_color"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# non-injective, different color, 1-4 balls
# python3 run_training.py model=inertia_balls_cnn_encoder datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=2 datamodule.dataset.properties_list=["x","y"] model.z_dim=2 model.disentangle_z_dim=2 datamodule.dataset.signed=False datamodule.n_balls=1 datamodule.dataset.output_sparse_offsets=False datamodule.dataset.injective=False datamodule.dataset.same_color=False model.known_mechanism=False datamodule.sparsity_degree=1 datamodule.known_mechanism=False model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cnn","non-injective","different_color"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# non-injective, same color, 1-4 balls
# python3 run_training.py model=inertia_balls_cnn_encoder datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=2 datamodule.dataset.properties_list=["x","y"] model.z_dim=2 model.disentangle_z_dim=2 datamodule.dataset.signed=False datamodule.n_balls=1 datamodule.dataset.output_sparse_offsets=False datamodule.dataset.injective=True datamodule.dataset.same_color=True model.known_mechanism=False datamodule.sparsity_degree=1 datamodule.known_mechanism=False model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cnn","injective","same_color"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# october 10th; 1 ball shape and color with x,y being fixed; can a cnn disentangle c,s? YES
# python3 run_training.py model=inertia_balls_cnn_encoder datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=2 datamodule.dataset.properties_list=["c","s"] model.z_dim=2 model.disentangle_z_dim=2 datamodule.dataset.signed=False datamodule.dataset.random_coordinates=False datamodule.n_balls=1 datamodule.dataset.output_sparse_offsets=False datamodule.dataset.injective=False datamodule.dataset.same_color=False model.known_mechanism=False datamodule.sparsity_degree=1 datamodule.known_mechanism=False model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cnn","non-injective","different_color"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# 1 ball all 4 properties; can a cnn disentangle x,y,c,s? NO
# python3 run_training.py model=inertia_balls_cnn_encoder datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","s"] model.z_dim=4 model.disentangle_z_dim=4 datamodule.dataset.signed=False datamodule.dataset.random_coordinates=True datamodule.n_balls=1 datamodule.dataset.output_sparse_offsets=False datamodule.dataset.injective=False datamodule.dataset.same_color=False model.known_mechanism=False datamodule.sparsity_degree=1 datamodule.known_mechanism=False model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cnn","non-injective","different_color"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# 1 ball, can a cnn disentangle x,y,c? NO
# python3 run_training.py model=inertia_balls_cnn_encoder datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","c"] model.z_dim=3 model.disentangle_z_dim=3 datamodule.dataset.signed=False datamodule.n_balls=1 datamodule.dataset.output_sparse_offsets=False datamodule.dataset.injective=False datamodule.dataset.same_color=False model.known_mechanism=False datamodule.sparsity_degree=1 datamodule.known_mechanism=False model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cnn","non-injective","different_color"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# 1 ball, can a cnn disentangle x,y,s? NO
# python3 run_training.py model=inertia_balls_cnn_encoder datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","s"] model.z_dim=3 model.disentangle_z_dim=3 datamodule.dataset.signed=False datamodule.dataset.random_coordinates=True datamodule.n_balls=1 datamodule.dataset.output_sparse_offsets=False datamodule.dataset.injective=False datamodule.dataset.same_color=False model.known_mechanism=False datamodule.sparsity_degree=1 datamodule.known_mechanism=False model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cnn","non-injective","different_color"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# ------------------------------------------------------------------------------------------------------------------------------
# October 13th. cnn encoder with 1 ball all properties has been successful. let's expand it now.
# injective cnn (injectivity induced by color), known mechanisms, signed offsets; 1-4 balls, x,y,s be disentangled
# python3 run_training.py model=inertia_balls_cnn_encoder datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","s"] model.z_dim=3 model.disentangle_z_dim=3 datamodule.dataset.signed=True datamodule.dataset.random_coordinates=True datamodule.n_balls=3 datamodule.dataset.output_sparse_offsets=False datamodule.dataset.injective=True datamodule.dataset.same_color=False model.known_mechanism=False datamodule.sparsity_degree=1 datamodule.known_mechanism=False model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cnn","injective","different_color"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# injective cnn (injectivity induced by color), unknown mechanisms, signed offsets; 1-4 balls, x,y,s be disentangled
# python3 run_training.py model=inertia_balls_cnn_encoder datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","s"] model.z_dim=3 model.disentangle_z_dim=3 datamodule.dataset.signed=True datamodule.dataset.random_coordinates=True datamodule.n_balls=1 datamodule.dataset.output_sparse_offsets=False datamodule.dataset.injective=True datamodule.dataset.same_color=False model.known_mechanism=False datamodule.sparsity_degree=1 datamodule.known_mechanism=False model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","cnn","injective","different_color"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2

# slot attention, known mechanisms, signed offsets; 2-4 balls, 4 properties, no matching for now. On top of a ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","s"] model.z_dim=4 model.encoder.slot_size=64 model.disentangle_z_dim=4 datamodule.dataset.signed=True datamodule.dataset.random_coordinates=True datamodule.n_balls=1 model.encoder.num_slots=2 datamodule.dataset.output_sparse_offsets=True datamodule.dataset.same_color=False model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.use_all_balls_mcc=False model.known_action=True model.rm_background_in_matching=True model.known_mechanism=True model.pair_recons=True datamodule.sparsity_degree=1 model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","slot-attention","different_color","all_properties"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"

# slot attention, unknown mechanisms, signed offsets; 2-4 balls, 4 properties, no matching for now. On top of a ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","s"] model.z_dim=4 model.encoder.slot_size=64 model.disentangle_z_dim=4 datamodule.dataset.signed=True datamodule.dataset.random_coordinates=True datamodule.n_balls=4 model.encoder.num_slots=5 datamodule.dataset.output_sparse_offsets=True datamodule.dataset.same_color=False model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.use_all_balls_mcc=False model.known_action=True model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","slot-attention","different_color","all_properties"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"

# October 18th. slot attention with all properties has been successful without matching for 2-4 balls with known or unknown mechanisms.
# now let's add matching to see how it goes. model.ball_matching=True (matching in play), model.double_matching=False & model.known_action=True

# 2 balls
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","s"] model.z_dim=4 model.encoder.slot_size=64 model.disentangle_z_dim=4 datamodule.dataset.signed=True datamodule.dataset.random_coordinates=True datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.dataset.output_sparse_offsets=True datamodule.dataset.same_color=False model.latent_matching="argmin" model.ball_matching=True model.double_matching=False model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.known_mechanism=True model.pair_recons=True datamodule.sparsity_degree=1 model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","slot-attention","different_color","all_properties"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"
# 3 balls
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","s"] model.z_dim=4 model.encoder.slot_size=64 model.disentangle_z_dim=4 datamodule.dataset.signed=True datamodule.dataset.random_coordinates=True datamodule.n_balls=3 model.encoder.num_slots=4 datamodule.dataset.output_sparse_offsets=True datamodule.dataset.same_color=False model.latent_matching="argmin" model.ball_matching=True model.double_matching=False model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","slot-attention","different_color","all_properties"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_3_cyclic_fixed/2022-09-13_22-33-09/checkpoints/slot_attention_inertia_balls_autoencoder_3_cyclic_fixed-epoch\=693-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"
# 4 balls
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","s"] model.z_dim=4 model.encoder.slot_size=64 model.disentangle_z_dim=4 datamodule.dataset.signed=True datamodule.dataset.random_coordinates=True datamodule.n_balls=4 model.encoder.num_slots=5 datamodule.dataset.output_sparse_offsets=True datamodule.dataset.same_color=False model.latent_matching="argmin" model.ball_matching=True model.double_matching=False model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","slot-attention","different_color","all_properties"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_4_cyclic_fixed/2022-09-13_22-37-43/checkpoints/slot_attention_inertia_balls_autoencoder_4_cyclic_fixed-epoch\=699-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"

# October 20th. slot attention with all properties has been successful without matching for 2-4 balls with known or unknown mechanisms.
# now using double matching. model.ball_matching=True, model.double_matching=True & model.known_action=True

# 2 balls
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","s"] model.z_dim=4 model.encoder.slot_size=64 model.disentangle_z_dim=4 datamodule.dataset.signed=True datamodule.dataset.random_coordinates=True datamodule.n_balls=2 model.encoder.num_slots=3 datamodule.dataset.output_sparse_offsets=True datamodule.dataset.same_color=False model.latent_matching="argmin" model.ball_matching=True model.double_matching=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","slot-attention","different_color","all_properties"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2022-09-13_22-33-10/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=670-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"
# 3 balls
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","s"] model.z_dim=4 model.encoder.slot_size=64 model.disentangle_z_dim=4 datamodule.dataset.signed=True datamodule.dataset.random_coordinates=True datamodule.n_balls=3 model.encoder.num_slots=4 datamodule.dataset.output_sparse_offsets=True datamodule.dataset.same_color=False model.latent_matching="argmin" model.ball_matching=True model.double_matching=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","slot-attention","different_color","all_properties"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_3_cyclic_fixed/2022-09-13_22-33-09/checkpoints/slot_attention_inertia_balls_autoencoder_3_cyclic_fixed-epoch\=693-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"
# 4 balls
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=inertia_balls datamodule/dataset=all_properties_sparse_offset datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","s"] model.z_dim=4 model.encoder.slot_size=64 model.disentangle_z_dim=4 datamodule.dataset.signed=True datamodule.dataset.random_coordinates=True datamodule.n_balls=4 model.encoder.num_slots=5 datamodule.dataset.output_sparse_offsets=True datamodule.dataset.same_color=False model.latent_matching="argmin" model.ball_matching=True model.double_matching=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=False model.known_mechanism=False model.pair_recons=True datamodule.sparsity_degree=1 model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model/optimizer=adamw model.optimizer.lr=0.0002 model.encoder_freeze=False callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","slot-attention","different_color","all_properties"] trainer.max_epochs=400 ckpt_path=null datamodule.dataset.dataset_parameters.train.dataset.offset_x=0.2 model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_4_cyclic_fixed/2022-09-13_22-37-43/checkpoints/slot_attention_inertia_balls_autoencoder_4_cyclic_fixed-epoch\=699-train_loss\=0.00-Linear_Disentanglement\=0.00-Permutation_Disentanglement\=0.00.ckpt"

# ------------------------------------------------------------------------------------- #
# ------------------------------------------------------------------------------------- #
# ------------------------------------------------------------------------------------- #
# ------------------------------------------------------------------------------------- #
# ------------------------------------------------------------------------------------- #
# --------------------------------- SPARSE CLEVR RUNS --------------------------------- #

# --------------------------------- Vanilla Slot Attn --------------------------------- #
# training from scratch
# using a checkpoint to continue training
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=2 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr","v0"] ckpt_path=null trainer.max_epochs=2000
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=8000 datamodule.start_idx.valid=8000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=9000 datamodule.num_samples.test=1000 datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=2 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","SA-Mesh","clevr"] trainer.max_epochs=4000 ckpt_path=null

# Good checkpoints for vanilla SA
# not quite sure what the following is
# /home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2023-01-29_00-28-54/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=924-train_ARI\=-0.00-Linear_Disentanglement_regression\=0.30-Permutation_Disentanglement_regression\=0.48.ckpt
# slot size 64
# /home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2023-01-29_16-40-52/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=1084-train_ARI\=0.00-Linear_Disentanglement_regression\=0.06-Permutation_Disentanglement_regression\=0.27.ckpt
# /home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2023-01-29_16-40-52/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=994-train_ARI\=-0.00-Linear_Disentanglement_regression\=0.07-Permutation_Disentanglement_regression\=0.27.ckpt
# /home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2023-02-04_00-23-08/checkpoints/last.ckpt
# /home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2023-02-04_14-38-02/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=4982-train_loss\=0.000061-Linear_Disentanglement_regression\=0.35-Permutation_Disentanglement_regression\=0.49.ckpt
# SA-MESH
# /home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-04-07_07-21-28/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=1824-train_loss\=0.000028-Linear_Disentanglement_regression\=0.45-Permutation_Disentanglement_regression\=0.64.ckpt

# with the new dataset where size also changes. "special". The ckpt starts from a good one for 2 balls
# python3 run_training.py datamodule=sparse_clevr datamodule.n_balls=2 datamodule.batch_size=256 model=inertia_balls_slot_attention_ae model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.00006 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr"] trainer.max_epochs=10000 ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_14-22-49/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=5008-train_loss\=0.000393-Linear_Disentanglement_regression\=0.39-Permutation_Disentanglement_regression\=0.51.ckpt"
# ckpts for special
# /home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_14-31-22/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=6033-train_loss\=0.000076-Linear_Disentanglement_regression\=0.41-Permutation_Disentanglement_regression\=0.50.ckpt
# /home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=6090-train_loss\=0.000081-Linear_Disentanglement_regression\=0.41-Permutation_Disentanglement_regression\=0.50.ckpt
# /home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=6108-train_loss\=0.000061-Linear_Disentanglement_regression\=0.42-Permutation_Disentanglement_regression\=0.51.ckpt
# /home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=9208-train_loss\=0.000051-Linear_Disentanglement_regression\=0.42-Permutation_Disentanglement_regression\=0.53.ckpt
# python3 run_training.py datamodule=sparse_clevr datamodule.n_balls=2 datamodule.batch_size=256 model=inertia_balls_slot_attention_ae model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.00006 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr"] trainer.max_epochs=15000 ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=9208-train_loss\=0.000051-Linear_Disentanglement_regression\=0.42-Permutation_Disentanglement_regression\=0.53.ckpt"
# --------------------------------- Disentanglement --------------------------------- #

# n_balls = 1
# zdim = 3 x,y,c
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","c"] datamodule.n_balls=1 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=3000 datamodule.start_idx.valid=3000 datamodule.num_samples.valid=500 datamodule.start_idx.test=3500 datamodule.num_samples.test=500 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2023-02-04_00-23-08/checkpoints/last.ckpt"
# zdim = 3 x,y,s
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","s"] datamodule.n_balls=1 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=3000 datamodule.start_idx.valid=3000 datamodule.num_samples.valid=500 datamodule.start_idx.test=3500 datamodule.num_samples.test=500 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2023-02-04_00-23-08/checkpoints/last.ckpt"
# zdim = 4 x,y,c,s
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","s"] datamodule.n_balls=1 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=8000 datamodule.start_idx.valid=8000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=9000 datamodule.num_samples.test=1000 model.z_dim=4 model.disentangle_z_dim=4 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2023-02-04_14-38-02/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=4982-train_loss\=0.000061-Linear_Disentanglement_regression\=0.35-Permutation_Disentanglement_regression\=0.49.ckpt"
# zdim = 4 x,y,s,l
# nice ckpt for this: /home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_4/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_4/2023-02-09_00-26-34/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_4-epoch\=11-train_loss\=0.72-Linear_Disentanglement\=0.61-Permutation_Disentanglement\=0.62.ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","s","l"] datamodule.n_balls=1 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=8000 datamodule.start_idx.valid=8000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=9000 datamodule.num_samples.test=1000 model.z_dim=4 model.disentangle_z_dim=4 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_4/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_4/2023-02-09_00-26-34/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_4-epoch\=11-train_loss\=0.72-Linear_Disentanglement\=0.61-Permutation_Disentanglement\=0.62.ckpt"
# zdim = 5 x,y,c,s,l
# some nice ckpt for this (frozen encoder): /home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-02-09_00-39-47/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=57-train_loss\=0.40-Linear_Disentanglement\=0.72-Permutation_Disentanglement\=0.78.ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=1 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=8000 datamodule.start_idx.valid=8000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=9000 datamodule.num_samples.test=1000 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=True model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-02-09_00-39-47/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=57-train_loss\=0.40-Linear_Disentanglement\=0.72-Permutation_Disentanglement\=0.78.ckpt"
# some nice ckpt for this (finetuned encoder): /home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-02-09_00-51-46/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=79-train_loss\=0.04-Linear_Disentanglement\=0.83-Permutation_Disentanglement\=0.83.ckpt
# better one: /home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-02-09_01-33-19/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=1379-train_loss\=0.00-Linear_Disentanglement\=0.95-Permutation_Disentanglement\=0.87.ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=1 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=8000 datamodule.start_idx.valid=8000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=9000 datamodule.num_samples.test=1000 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-02-09_01-33-19/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=1379-train_loss\=0.00-Linear_Disentanglement\=0.95-Permutation_Disentanglement\=0.87.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=1 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=8000 datamodule.start_idx.valid=8000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=9000 datamodule.num_samples.test=1000 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-02-09_01-33-19/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=1379-train_loss\=0.00-Linear_Disentanglement\=0.95-Permutation_Disentanglement\=0.87.ckpt"

# evaluation
# python3 run_evaluation.py model=inertia_balls_saae_contrastive_recons_ckpt datamodule=sparse_clevr datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=1 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=8000 datamodule.start_idx.valid=8000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=9000 datamodule.num_samples.test=1000 model.n_balls=1 model.z_dim=5 +model.disentangle_z_dim=4 model.latent_matching="argmin" ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","no_matching","clevr","eval"] ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-02-09_01-33-19/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=1379-train_loss\=0.00-Linear_Disentanglement\=0.95-Permutation_Disentanglement\=0.87.ckpt"

# ------------------------------------------------------ #
# n_balls = 2
# zdim = 2
# nice ckpt for x,y: /home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_2/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_2/2023-02-25_20-19-47/checkpoints/SA_inertia_balls_contrastive_recons_zdim_2/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_2-epoch\=53-train_loss\=0.05-Linear_Disentanglement\=0.97-Permutation_Disentanglement\=0.98.ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=2 datamodule.dataset.properties_list=["x","y"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=2 model.disentangle_z_dim=2 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2023-02-04_00-23-08/checkpoints/last.ckpt"
# with SA-Mesh
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=2 datamodule.dataset.properties_list=["x","y"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=2 model.disentangle_z_dim=2 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-04-07_07-21-28/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=866-train_loss\=0.000053-Linear_Disentanglement_regression\=0.44-Permutation_Disentanglement_regression\=0.64.ckpt"

# zdim = 3 x,y,c
# from slot attention ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","c"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-04-07_07-21-28/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=1824-train_loss\=0.000028-Linear_Disentanglement_regression\=0.45-Permutation_Disentanglement_regression\=0.64.ckpt"
# from x,y, disentangled ckpt (curriculum)
# ?
# with SA-Mesh, from VSA ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","c"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-04-07_07-21-28/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=1824-train_loss\=0.000028-Linear_Disentanglement_regression\=0.45-Permutation_Disentanglement_regression\=0.64.ckpt"
# with SA-Mesh, from SA-Mesh ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","c"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=40.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-04-11_09-44-29/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=05-train_loss\=0.21-Linear_Disentanglement\=0.78-Permutation_Disentanglement\=0.86.ckpt"
# zdim = 3 x,y,s
# from slot attention ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","s"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1000 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2023-02-04_00-23-08/checkpoints/last.ckpt"
# with SA-Mesh
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","s"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-04-07_07-21-28/checkpoints/last.ckpt"

# zdim = 4
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","s"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=4 model.disentangle_z_dim=4 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1000 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2023-02-04_00-23-08/checkpoints/last.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=2 datamodule.dataset.properties_list=["x","y"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=2 model.disentangle_z_dim=2 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=100.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed/2023-01-29_16-40-52/checkpoints/slot_attention_inertia_balls_autoencoder_2_cyclic_fixed-epoch\=1084-train_ARI\=0.00-Linear_Disentanglement_regression\=0.06-Permutation_Disentanglement_regression\=0.27.ckpt"
# with SA-Mesh
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","s"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=4 model.disentangle_z_dim=4 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-04-07_07-21-28/checkpoints/last.ckpt"

# zdim = 5 x,y,c,s,l
# with slot attention ckpt
# /home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=9208-train_loss\=0.000051-Linear_Disentanglement_regression\=0.42-Permutation_Disentanglement_regression\=0.53.ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=8000 datamodule.start_idx.valid=8000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=9000 datamodule.num_samples.test=1000 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=True model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=10983-train_loss\=0.000047-Linear_Disentanglement_regression\=0.44-Permutation_Disentanglement_regression\=0.53.ckpt" # model.target_property_indices=[0,1,2,3,4]
# no curriculum, all properties right after slot attention ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=18000 datamodule.start_idx.valid=18000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=19000 datamodule.num_samples.test=1000 model.z_dim=5 model.target_property_indices=[0,1,2,3,4] model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="val_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=10983-train_loss\=0.000047-Linear_Disentanglement_regression\=0.44-Permutation_Disentanglement_regression\=0.53.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=1000 datamodule.start_idx.valid=18000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=19000 datamodule.num_samples.test=1000 model.z_dim=5 model.target_property_indices=[0,1,2,3,4] model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="val_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=10983-train_loss\=0.000047-Linear_Disentanglement_regression\=0.44-Permutation_Disentanglement_regression\=0.53.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=2 datamodule.dataset.properties_list=["x","y"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=1000 datamodule.start_idx.valid=18000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=19000 datamodule.num_samples.test=1000 model.z_dim=2 model.target_property_indices=[0,1] model.disentangle_z_dim=2 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="val_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=10983-train_loss\=0.000047-Linear_Disentanglement_regression\=0.44-Permutation_Disentanglement_regression\=0.53.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","c"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=18000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=19000 datamodule.num_samples.test=1000 model.z_dim=3 model.target_property_indices=[0,1,2] model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="val_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=10983-train_loss\=0.000047-Linear_Disentanglement_regression\=0.44-Permutation_Disentanglement_regression\=0.53.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","c"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=12000 datamodule.start_idx.valid=12000 datamodule.num_samples.valid=2000 datamodule.start_idx.test=14000 datamodule.num_samples.test=2000 model.z_dim=3 model.target_property_indices=[0,1,2] model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="val_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-03-13_14-54-22/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=34-val_loss\=0.10-Linear_Disentanglement\=0.68-Permutation_Disentanglement\=0.71.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=2 datamodule.dataset.properties_list=["x","c"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=18000 datamodule.start_idx.valid=18000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=19000 datamodule.num_samples.test=1000 model.z_dim=2 model.target_property_indices=[0,1] model.disentangle_z_dim=2 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="val_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=10983-train_loss\=0.000047-Linear_Disentanglement_regression\=0.44-Permutation_Disentanglement_regression\=0.53.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=1 datamodule.dataset.properties_list=["c"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=18000 datamodule.start_idx.valid=18000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=19000 datamodule.num_samples.test=1000 model.z_dim=1 model.target_property_indices=[0] model.disentangle_z_dim=1 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="val_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=10983-train_loss\=0.000047-Linear_Disentanglement_regression\=0.44-Permutation_Disentanglement_regression\=0.53.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-04-07_07-21-28/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=866-train_loss\=0.000053-Linear_Disentanglement_regression\=0.44-Permutation_Disentanglement_regression\=0.64.ckpt"
# with SA-Mesh
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-04-07_07-21-28/checkpoints/last.ckpt"


# curriculum
# 2, the following line should run from a slot attention ckpt and results in this ckpt to be used for the next stage in the curriculum: /home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_2/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_2/2023-02-25_23-36-43/checkpoints/SA_inertia_balls_contrastive_recons_zdim_2/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_2-epoch\=30-train_loss\=0.04-Linear_Disentanglement\=0.94-Permutation_Disentanglement\=0.97.ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=2 datamodule.dataset.properties_list=["x","y"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=8000 datamodule.start_idx.valid=8000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=9000 datamodule.num_samples.test=1000 model.z_dim=5 model.target_property_indices=[0,1] model.disentangle_z_dim=2 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="val_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=10983-train_loss\=0.000047-Linear_Disentanglement_regression\=0.44-Permutation_Disentanglement_regression\=0.53.ckpt" # model.target_property_indices=[0,1,2,3,4]
# 3, the following line should run from a previous stage of the curriculum ckpt and results in this ckpt to be used for the next stage in the curriculum: /home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-02-26_01-50-24/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=1942-train_loss\=0.04-Linear_Disentanglement\=0.78-Permutation_Disentanglement\=0.87.ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","c"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=8000 datamodule.start_idx.valid=8000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=9000 datamodule.num_samples.test=1000 model.z_dim=5 model.target_property_indices=[0,1,2] model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="val_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_2/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_2/2023-02-25_23-36-43/checkpoints/SA_inertia_balls_contrastive_recons_zdim_2/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_2-epoch\=30-train_loss\=0.04-Linear_Disentanglement\=0.94-Permutation_Disentanglement\=0.97.ckpt"
# 4, the following line should run from a previous stage of the curriculum ckpt and results in this ckpt to be used for the next stage in the curriculum: /home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_4/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_4/2023-02-26_12-43-56/checkpoints/SA_inertia_balls_contrastive_recons_zdim_4/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_4-epoch\=3942-train_loss\=0.04-Linear_Disentanglement\=0.78-Permutation_Disentanglement\=0.85.ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","s"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=8000 datamodule.start_idx.valid=8000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=9000 datamodule.num_samples.test=1000 model.z_dim=5 model.target_property_indices=[0,1,2,3] model.disentangle_z_dim=4 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="val_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=4000 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-02-26_01-50-24/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=1942-train_loss\=0.04-Linear_Disentanglement\=0.78-Permutation_Disentanglement\=0.87.ckpt"
# 5, the following line should run from a previous stage of the curriculum ckpt and results in this ckpt to be used for the next stage in the curriculum: ???
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=18000 datamodule.start_idx.valid=18000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=19000 datamodule.num_samples.test=1000 model.z_dim=5 model.target_property_indices=[0,1,2,3,4] model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="val_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=6000 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_4/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_4/2023-02-26_12-43-56/checkpoints/SA_inertia_balls_contrastive_recons_zdim_4/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_4-epoch\=3942-train_loss\=0.04-Linear_Disentanglement\=0.78-Permutation_Disentanglement\=0.85.ckpt"
# same as above, but not in curriculum, just with 20k samples, after several epochs (on top of a VSA)
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=18000 datamodule.start_idx.valid=18000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=19000 datamodule.num_samples.test=1000 model.z_dim=5 model.target_property_indices=[0,1,2,3,4] model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.00002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="val_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=6000 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-03-02_21-32-22/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=12-val_loss\=0.28-Linear_Disentanglement\=0.53-Permutation_Disentanglement\=0.64.ckpt"
# with complete model ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=2 datamodule.batch_size=256 datamodule.start_idx.train=0 datamodule.num_samples.train=8000 datamodule.start_idx.valid=8000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=9000 datamodule.num_samples.test=1000 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-02-16_20-31-10/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=6108-train_loss\=0.000061-Linear_Disentanglement_regression\=0.42-Permutation_Disentanglement_regression\=0.51.ckpt" # model.target_property_indices=[0,1,2,3,4]

# evaluation
# +model.encoder_ckpt_path=null this is crucial, o.w. a statedict could be read corresponding to a model that does not exist in this directory
# python3 run_evaluation.py model=inertia_balls_saae_contrastive_recons_ckpt +model.target_property_indices=[0,1,2,3,4] +model.encoder_ckpt_path=null datamodule=sparse_clevr datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=2 datamodule.batch_size=256 model.n_balls=2 model.z_dim=5 +model.disentangle_z_dim=5 ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping logger.wandb.tags=["narval","disentanglement","no_matching","clevr","eval"] ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-02-16_23-43-01/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=1999-train_loss\=0.08-Linear_Disentanglement\=0.39-Permutation_Disentanglement\=0.61.ckpt"

# ------------------------------------------------------ #
# special dataset, all properties, x,y,c,s,l

# --------------------# --------------------
# -------------------- n_balls=1
# --------------------# --------------------

# ---------- SA-Mesh ---------- #
# training from scratch
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=9000 datamodule.start_idx.valid=9000 datamodule.num_samples.valid=500 datamodule.start_idx.test=9500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=5 datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/1/special/" datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=1 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr"] trainer.max_epochs=4000 ckpt_path=null
# the above results in an interesting ckpt: "/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_1_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_1_cyclic_fixed-epoch\=3574-train_loss\=0.000015-Linear_Disentanglement_regression\=0.96-Permutation_Disentanglement_regression\=0.98.ckpt"

# training from scratch ---- all properties (xycslp)
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=9000 datamodule.start_idx.valid=9000 datamodule.num_samples.valid=500 datamodule.start_idx.test=9500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=6 datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/1/all_p/" datamodule.dataset.properties_list=["x","y","c","s","l","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr"] trainer.max_epochs=6000 ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_1_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_1_cyclic_fixed-epoch\=3574-train_loss\=0.000015-Linear_Disentanglement_regression\=0.96-Permutation_Disentanglement_regression\=0.98.ckpt"
# ckpt for training from scratch: "/home/aminm/scratch/logs/training/runs/slot_attention_xycslp_autoencoder_1_cyclic_fixed/2023-04-27_04-54-45/checkpoints/slot_attention_xycslp_autoencoder_1_cyclic_fixed-epoch\=3424-train_loss\=0.000012-Linear_Disentanglement_regression\=0.97-Permutation_Disentanglement_regression\=0.99.ckpt"
# ckpt for training from xycsl ckpt: "/home/aminm/scratch/logs/training/runs/slot_attention_xycslp_autoencoder_1_cyclic_fixed/2023-04-27_07-31-58/checkpoints/slot_attention_xycslp_autoencoder_1_cyclic_fixed-epoch=5924-train_loss=0.000013-Linear_Disentanglement_regression=0.94-Permutation_Disentanglement_regression=0.97.ckpt"

# ---------- Disentanglement ---------- #
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/1/special/" datamodule.start_idx.train=0 datamodule.num_samples.train=9000 datamodule.start_idx.valid=9000 datamodule.num_samples.valid=500 datamodule.start_idx.test=9500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","special"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_1_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_1_cyclic_fixed-epoch\=3574-train_loss\=0.000015-Linear_Disentanglement_regression\=0.96-Permutation_Disentanglement_regression\=0.98.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/1/special/" datamodule.start_idx.train=0 datamodule.num_samples.train=100 datamodule.start_idx.valid=0 datamodule.num_samples.valid=100 datamodule.start_idx.test=0 datamodule.num_samples.test=100 datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=True model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","special"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_1_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_1_cyclic_fixed-epoch\=3574-train_loss\=0.000015-Linear_Disentanglement_regression\=0.96-Permutation_Disentanglement_regression\=0.98.ckpt"
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-04-22_02-51-36/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=1934-train_loss\=0.00-Linear_Disentanglement\=0.82-Permutation_Disentanglement\=0.85.ckpt"
# more data
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/1/special/" datamodule.start_idx.train=0 datamodule.num_samples.train=18000 datamodule.start_idx.valid=18000 datamodule.num_samples.valid=1000 datamodule.start_idx.test=19000 datamodule.num_samples.test=1000 datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=True model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","special"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_1_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_1_cyclic_fixed-epoch\=3574-train_loss\=0.000015-Linear_Disentanglement_regression\=0.96-Permutation_Disentanglement_regression\=0.98.ckpt"
# resulting ckpt:                          "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-04-27_07-06-12/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=1379-train_loss\=0.00-Linear_Disentanglement\=0.86-Permutation_Disentanglement\=0.84.ckpt"
# x,y,p
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/1/all_p/" datamodule.start_idx.train=0 datamodule.num_samples.train=9000 datamodule.start_idx.valid=9000 datamodule.num_samples.valid=500 datamodule.start_idx.test=9500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","special"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_1_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_1_cyclic_fixed-epoch\=3574-train_loss\=0.000015-Linear_Disentanglement_regression\=0.96-Permutation_Disentanglement_regression\=0.98.ckpt"

# x,y,z
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/1/xyz/" datamodule.start_idx.train=0 datamodule.num_samples.train=2000 datamodule.start_idx.valid=2000 datamodule.num_samples.valid=500 datamodule.start_idx.test=2500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","z"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","special"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_1_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_1_cyclic_fixed-epoch\=3574-train_loss\=0.000015-Linear_Disentanglement_regression\=0.96-Permutation_Disentanglement_regression\=0.98.ckpt"

# training from scratch ---- x,y,c,s,l,p
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/1/all_p/" datamodule.start_idx.train=0 datamodule.num_samples.train=9000 datamodule.start_idx.valid=9000 datamodule.num_samples.valid=500 datamodule.start_idx.test=9500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=6 datamodule.dataset.properties_list=["x","y","c","s","l","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=6 model.disentangle_z_dim=6 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","special"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_1_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_1_cyclic_fixed-epoch\=3574-train_loss\=0.000015-Linear_Disentanglement_regression\=0.96-Permutation_Disentanglement_regression\=0.98.ckpt"
# results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_6/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_6/2023-04-27_05-03-27/checkpoints/SA_inertia_balls_contrastive_recons_zdim_6/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_6-epoch\=1904-train_loss\=0.00-Linear_Disentanglement\=0.79-Permutation_Disentanglement\=0.82.ckpt"
# from the above ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/1/all_p/" datamodule.start_idx.train=0 datamodule.num_samples.train=9000 datamodule.start_idx.valid=9000 datamodule.num_samples.valid=500 datamodule.start_idx.test=9500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=6 datamodule.dataset.properties_list=["x","y","c","s","l","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=6 model.disentangle_z_dim=6 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","special"] trainer.max_epochs=2000 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_6/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_6/2023-04-27_05-03-27/checkpoints/SA_inertia_balls_contrastive_recons_zdim_6/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_6-epoch\=1904-train_loss\=0.00-Linear_Disentanglement\=0.79-Permutation_Disentanglement\=0.82.ckpt"

# x,y,c,p (cube only)
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/1/xycp/" datamodule.start_idx.train=0 datamodule.num_samples.train=2000 datamodule.start_idx.valid=2000 datamodule.num_samples.valid=500 datamodule.start_idx.test=2500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=4 model.disentangle_z_dim=4 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","special"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_1_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_1_cyclic_fixed-epoch\=3574-train_loss\=0.000015-Linear_Disentanglement_regression\=0.96-Permutation_Disentanglement_regression\=0.98.ckpt"
# results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_4/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_4/2023-04-27_09-55-01/checkpoints/SA_inertia_balls_contrastive_recons_zdim_4/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_4-epoch\=1744-train_loss\=0.00-Linear_Disentanglement\=0.93-Permutation_Disentanglement\=0.94.ckpt"

# x,y,c,l,p (cube only)
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/1/xyclp/" datamodule.start_idx.train=0 datamodule.num_samples.train=2000 datamodule.start_idx.valid=2000 datamodule.num_samples.valid=500 datamodule.start_idx.test=2500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","l","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","special"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_1_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_1_cyclic_fixed-epoch\=3574-train_loss\=0.000015-Linear_Disentanglement_regression\=0.96-Permutation_Disentanglement_regression\=0.98.ckpt"
# results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-04-27_11-22-43/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=1939-train_loss\=0.00-Linear_Disentanglement\=0.91-Permutation_Disentanglement\=0.92.ckpt"

# x,y,z,c,p (cube only)
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/1/xyzcp/" datamodule.start_idx.train=0 datamodule.num_samples.train=2000 datamodule.start_idx.valid=2000 datamodule.num_samples.valid=500 datamodule.start_idx.test=2500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","z","c","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","special"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_1_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_1_cyclic_fixed-epoch\=3574-train_loss\=0.000015-Linear_Disentanglement_regression\=0.96-Permutation_Disentanglement_regression\=0.98.ckpt"

# --------------------# --------------------
# -------------------- n_balls=2
# --------------------# --------------------

# ---------- SA-Mesh ---------- #
# training from scratch (x,y,c,s,l)
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=9000 datamodule.start_idx.valid=9000 datamodule.num_samples.valid=500 datamodule.start_idx.test=9500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=5 datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/2/special/" datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=2 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr"] trainer.max_epochs=4000 ckpt_path=null
# the above results in an interesting ckpt: "/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=3119-train_loss\=0.000029-Linear_Disentanglement_regression\=0.40-Permutation_Disentanglement_regression\=0.56.ckpt"

# training from scratch (x,y,c,p) (cube only)
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/2/xycp/" datamodule.start_idx.train=0 datamodule.num_samples.train=2000 datamodule.start_idx.valid=2000 datamodule.num_samples.valid=500 datamodule.start_idx.test=2500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","p"] datamodule.n_balls=2 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr"] trainer.max_epochs=4000 ckpt_path=null

# ---------- Disentanglement ---------- #
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/2/special/" datamodule.start_idx.train=0 datamodule.num_samples.train=9000 datamodule.start_idx.valid=9000 datamodule.num_samples.valid=500 datamodule.start_idx.test=9500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","special"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-04-21_07-32-11/checkpoints/last.ckpt"
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-04-22_02-51-36/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=1969-train_loss\=0.01-Linear_Disentanglement\=0.65-Permutation_Disentanglement\=0.70.ckpt"

# x,y,c,p (cube only)
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/2/xycp/" datamodule.start_idx.train=0 datamodule.num_samples.train=2000 datamodule.start_idx.valid=2000 datamodule.num_samples.valid=500 datamodule.start_idx.test=2500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","p"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=4 model.disentangle_z_dim=4 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=True model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","special"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_2_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_2_cyclic_fixed-epoch\=3119-train_loss\=0.000029-Linear_Disentanglement_regression\=0.40-Permutation_Disentanglement_regression\=0.56.ckpt"
# results in the following ckpt: "???"

# --------------------# --------------------
# -------------------- n_balls=3
# --------------------# --------------------
# ---------- SA-Mesh ---------- #
# training from scratch
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=9000 datamodule.start_idx.valid=9000 datamodule.num_samples.valid=500 datamodule.start_idx.test=9500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=5 datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/3/special/" datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=3 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr"] trainer.max_epochs=4000 ckpt_path=null
# the above results in an interesting ckpt: "/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_3_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_3_cyclic_fixed-epoch\=2799-train_loss\=0.000074-Linear_Disentanglement_regression\=0.26-Permutation_Disentanglement_regression\=0.42.ckpt"

# training from scratch (x,y,c,p) (cube only)
python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/3/xycp/" datamodule.start_idx.train=0 datamodule.num_samples.train=2000 datamodule.start_idx.valid=2000 datamodule.num_samples.valid=500 datamodule.start_idx.test=2500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","p"] datamodule.n_balls=3 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr"] trainer.max_epochs=4000 ckpt_path=null

# ---------- Disentanglement ---------- #
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/3/special/" datamodule.start_idx.train=0 datamodule.num_samples.train=9000 datamodule.start_idx.valid=9000 datamodule.num_samples.valid=500 datamodule.start_idx.test=9500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=5 datamodule.dataset.properties_list=["x","y","c","s","l"] datamodule.n_balls=3 datamodule.batch_size=256 model.z_dim=5 model.disentangle_z_dim=5 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","special"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_3_cyclic_fixed/2023-04-21_07-32-11/checkpoints/last.ckpt"
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_3/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5/2023-04-22_02-51-36/checkpoints/SA_inertia_balls_contrastive_recons_zdim_5/n_balls_3/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_5-epoch\=1609-train_loss\=0.03-Linear_Disentanglement\=0.39-Permutation_Disentanglement\=0.55.ckpt"

# x,y,c,p (cube only)
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/3/xycp/" datamodule.start_idx.train=0 datamodule.num_samples.train=2000 datamodule.start_idx.valid=2000 datamodule.num_samples.valid=500 datamodule.start_idx.test=2500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=4 datamodule.dataset.properties_list=["x","y","c","p"] datamodule.n_balls=3 datamodule.batch_size=256 model.z_dim=4 model.disentangle_z_dim=4 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=True model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xycsl_autoencoder_3_cyclic_fixed/2023-04-21_07-32-11/checkpoints/slot_attention_xycsl_autoencoder_3_cyclic_fixed-epoch\=2799-train_loss\=0.000074-Linear_Disentanglement_regression\=0.26-Permutation_Disentanglement_regression\=0.42.ckpt"
# results in the following ckpt: "???"

# ------------------------------------------------------ #
# cube and angle
# -------------------- n_balls=1

# ---------- SA-Mesh ---------- #
# training from scratch, v0,v1
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=2000 datamodule.start_idx.valid=2000 datamodule.num_samples.valid=500 datamodule.start_idx.test=2500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr"] ckpt_path=null trainer.max_epochs=2000
# the above results in an interesting ckpt for v0: "/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_1_cyclic_fixed/2023-04-15_20-13-02/checkpoints/slot_attention_xyp_autoencoder_1_cyclic_fixed-epoch\=1999-train_loss\=0.000090-Linear_Disentanglement_regression\=0.89-Permutation_Disentanglement_regression\=0.95.ckpt"
# the above results in an interesting ckpt for v1: "/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_1_cyclic_fixed/2023-04-16_09-15-30/checkpoints/slot_attention_xyp_autoencoder_1_cyclic_fixed-epoch\=1999-train_loss\=0.000151-Linear_Disentanglement_regression\=0.80-Permutation_Disentanglement_regression\=0.89.ckpt"

# training from scratch, v2
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr","v2"] ckpt_path=null trainer.max_epochs=2000
# the above results the following ckpt for v2: "/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_1_cyclic_fixed/2023-04-16_11-10-13/checkpoints/slot_attention_xyp_autoencoder_1_cyclic_fixed-epoch\=1999-train_loss\=0.000095-Linear_Disentanglement_regression\=0.82-Permutation_Disentanglement_regression\=0.89.ckpt"

# ---------- Disentanglement ---------- #
# v0
# zdim = 3 x,y,phi
# with SA-Mesh, from SA-Mesh ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=2000 datamodule.start_idx.valid=2000 datamodule.num_samples.valid=500 datamodule.start_idx.test=2500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_1_cyclic_fixed/2023-04-15_20-13-02/checkpoints/slot_attention_xyp_autoencoder_1_cyclic_fixed-epoch\=1999-train_loss\=0.000090-Linear_Disentanglement_regression\=0.89-Permutation_Disentanglement_regression\=0.95.ckpt"
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-04-16_06-33-09/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=169-train_loss\=0.01-Linear_Disentanglement\=0.97-Permutation_Disentanglement\=0.93.ckpt"
# with SA-Mesh, from full model ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=800 datamodule.start_idx.valid=800 datamodule.num_samples.valid=100 datamodule.start_idx.test=900 datamodule.num_samples.test=100 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-04-15_07-38-16/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=19-train_loss\=0.09-Linear_Disentanglement\=0.63-Permutation_Disentanglement\=0.66.ckpt"

# v1
# zdim = 3 x,y,phi
# with SA-Mesh, from SA-Mesh ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=2000 datamodule.start_idx.valid=2000 datamodule.num_samples.valid=500 datamodule.start_idx.test=2500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","v1"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_1_cyclic_fixed/2023-04-16_09-15-30/checkpoints/slot_attention_xyp_autoencoder_1_cyclic_fixed-epoch\=1999-train_loss\=0.000151-Linear_Disentanglement_regression\=0.80-Permutation_Disentanglement_regression\=0.89.ckpt"
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-04-16_19-10-14/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=1944-train_loss\=0.01-Linear_Disentanglement\=0.92-Permutation_Disentanglement\=0.87.ckpt"
# with SA-Mesh, from full model ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=800 datamodule.start_idx.valid=800 datamodule.num_samples.valid=100 datamodule.start_idx.test=900 datamodule.num_samples.test=100 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=???

# v2
# zdim = 3 x,y,phi
# with SA-Mesh, from SA-Mesh ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","v2"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_1_cyclic_fixed/2023-04-16_11-10-13/checkpoints/slot_attention_xyp_autoencoder_1_cyclic_fixed-epoch\=1999-train_loss\=0.000095-Linear_Disentanglement_regression\=0.82-Permutation_Disentanglement_regression\=0.89.ckpt"
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-04-16_18-57-28/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch=1954-train_loss=0.00-Linear_Disentanglement=0.86-Permutation_Disentanglement=0.85.ckpt"
# with SA-Mesh, from full model ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=800 datamodule.start_idx.valid=800 datamodule.num_samples.valid=100 datamodule.start_idx.test=900 datamodule.num_samples.test=100 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=???


# -------------------- n_balls=2

# ---------- SA-Mesh ---------- #

# training from scratch, v0
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=2 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr","v0"] ckpt_path=null trainer.max_epochs=2000
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_2_cyclic_fixed/2023-04-16_11-13-31/checkpoints/slot_attention_xyp_autoencoder_2_cyclic_fixed-epoch\=1943-train_loss\=0.000059-Linear_Disentanglement_regression\=0.22-Permutation_Disentanglement_regression\=0.44.ckpt"

# training from scratch, v1
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=2 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr","v1"] ckpt_path=null trainer.max_epochs=2000
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_2_cyclic_fixed/2023-04-16_18-48-02/checkpoints/slot_attention_xyp_autoencoder_2_cyclic_fixed-epoch\=1999-train_loss\=0.000109-Linear_Disentanglement_regression\=0.22-Permutation_Disentanglement_regression\=0.40.ckpt"

# training from scratch, v2
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=2 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr","v2"] ckpt_path=null trainer.max_epochs=2000
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_2_cyclic_fixed/2023-04-16_18-54-19/checkpoints/slot_attention_xyp_autoencoder_2_cyclic_fixed-epoch\=1424-train_loss\=0.000381-Linear_Disentanglement_regression\=0.24-Permutation_Disentanglement_regression\=0.48.ckpt"

# ---------- Disentanglement ---------- #
# v0
# zdim = 3 x,y,phi
# with SA-Mesh, from SA-Mesh ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","v0"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_2_cyclic_fixed/2023-04-16_11-13-31/checkpoints/slot_attention_xyp_autoencoder_2_cyclic_fixed-epoch\=1893-train_loss\=0.000065-Linear_Disentanglement_regression\=0.19-Permutation_Disentanglement_regression\=0.41.ckpt"
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","v0"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_2_cyclic_fixed/2023-04-16_11-13-31/checkpoints/slot_attention_xyp_autoencoder_2_cyclic_fixed-epoch\=1893-train_loss\=0.000065-Linear_Disentanglement_regression\=0.19-Permutation_Disentanglement_regression\=0.41.ckpt"
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-04-16_19-23-04/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=1979-train_loss\=0.00-Linear_Disentanglement\=0.98-Permutation_Disentanglement\=0.95.ckpt"
# with SA-Mesh, from full model ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=800 datamodule.start_idx.valid=800 datamodule.num_samples.valid=100 datamodule.start_idx.test=900 datamodule.num_samples.test=100 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path="/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-04-15_07-38-16/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_1/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=19-train_loss\=0.09-Linear_Disentanglement\=0.63-Permutation_Disentanglement\=0.66.ckpt"

# v1
# zdim = 3 x,y,phi
# with SA-Mesh, from SA-Mesh ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","v1"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_2_cyclic_fixed/2023-04-16_18-48-02/checkpoints/slot_attention_xyp_autoencoder_2_cyclic_fixed-epoch\=1999-train_loss\=0.000109-Linear_Disentanglement_regression\=0.22-Permutation_Disentanglement_regression\=0.40.ckpt"
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-04-17_09-34-16/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=1982-train_loss\=0.01-Linear_Disentanglement\=0.93-Permutation_Disentanglement\=0.90.ckpt"
# with SA-Mesh, from full model ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=800 datamodule.start_idx.valid=800 datamodule.num_samples.valid=100 datamodule.start_idx.test=900 datamodule.num_samples.test=100 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=???


# v2
# zdim = 3 x,y,phi
# with SA-Mesh, from SA-Mesh ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=2 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","v2"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_2_cyclic_fixed/2023-04-16_18-54-19/checkpoints/slot_attention_xyp_autoencoder_2_cyclic_fixed-epoch\=1424-train_loss\=0.000381-Linear_Disentanglement_regression\=0.24-Permutation_Disentanglement_regression\=0.48.ckpt"
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-04-17_11-38-04/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_2/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=1914-train_loss\=0.01-Linear_Disentanglement\=0.81-Permutation_Disentanglement\=0.80.ckpt"
# with SA-Mesh, from full model ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=800 datamodule.start_idx.valid=800 datamodule.num_samples.valid=100 datamodule.start_idx.test=900 datamodule.num_samples.test=100 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=1 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=???


# -------------------- n_balls=3

# ---------- SA-Mesh ---------- #

# training from scratch, v0
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=3 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr","v0"] ckpt_path=null trainer.max_epochs=2000
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_3_cyclic_fixed/2023-04-18_04-48-22/checkpoints/slot_attention_xyp_autoencoder_3_cyclic_fixed-epoch\=1999-train_loss\=0.000096-Linear_Disentanglement_regression\=0.07-Permutation_Disentanglement_regression\=0.30.ckpt"

# training from scratch, v1
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=3 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr","v1"] ckpt_path=null trainer.max_epochs=2000
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_3_cyclic_fixed/2023-04-20_07-42-34/checkpoints/slot_attention_xyp_autoencoder_3_cyclic_fixed-epoch\=1549-train_loss\=0.000348-Linear_Disentanglement_regression\=0.05-Permutation_Disentanglement_regression\=0.28.ckpt"

# training from scratch, v2
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=3 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr","v2"] ckpt_path=null trainer.max_epochs=2000
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_3_cyclic_fixed/2023-04-18_04-55-00/checkpoints/slot_attention_xyp_autoencoder_3_cyclic_fixed-epoch\=1974-train_loss\=0.000339-Linear_Disentanglement_regression\=0.06-Permutation_Disentanglement_regression\=0.27.ckpt"
# resuming from the above ckpt
# python3 run_training.py model=inertia_balls_slot_attention_ae datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=3 datamodule.batch_size=256 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.additional_logger.logging_interval=400 callbacks=vanilla_slot_attention ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","vanilla_SA","clevr","v2"] ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_3_cyclic_fixed/2023-04-18_04-55-00/checkpoints/slot_attention_xyp_autoencoder_3_cyclic_fixed-epoch\=1974-train_loss\=0.000339-Linear_Disentanglement_regression\=0.06-Permutation_Disentanglement_regression\=0.27.ckpt" trainer.max_epochs=4000
# results in the following ckpt: "/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_3_cyclic_fixed/2023-04-20_08-24-07/checkpoints/slot_attention_xyp_autoencoder_3_cyclic_fixed-epoch\=3324-train_loss\=0.000219-Linear_Disentanglement_regression\=0.07-Permutation_Disentanglement_regression\=0.27.ckpt"

# ---------- Disentanglement ---------- #
# v0
# zdim = 3 x,y,phi
# with SA-Mesh, from SA-Mesh ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/3/cube_angle/v0" datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=3 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","v0"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_3_cyclic_fixed/2023-04-18_04-48-22/checkpoints/slot_attention_xyp_autoencoder_3_cyclic_fixed-epoch\=1999-train_loss\=0.000096-Linear_Disentanglement_regression\=0.07-Permutation_Disentanglement_regression\=0.30.ckpt"
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_3/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-04-20_20-40-28/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_3/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=1989-train_loss\=0.01-Linear_Disentanglement\=0.96-Permutation_Disentanglement\=0.96.ckpt"
# with SA-Mesh, from full model ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=800 datamodule.start_idx.valid=800 datamodule.num_samples.valid=100 datamodule.start_idx.test=900 datamodule.num_samples.test=100 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=3 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path="???"

# v1
# zdim = 3 x,y,phi
# with SA-Mesh, from SA-Mesh ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/3/cube_angle/v1" datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=3 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","v1"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_3_cyclic_fixed/2023-04-20_07-42-34/checkpoints/slot_attention_xyp_autoencoder_3_cyclic_fixed-epoch\=1549-train_loss\=0.000348-Linear_Disentanglement_regression\=0.05-Permutation_Disentanglement_regression\=0.28.ckpt"
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_3/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-04-20_18-48-09/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_3/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=1984-train_loss\=0.01-Linear_Disentanglement\=0.92-Permutation_Disentanglement\=0.90.ckpt"
# with SA-Mesh, from full model ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=800 datamodule.start_idx.valid=800 datamodule.num_samples.valid=100 datamodule.start_idx.test=900 datamodule.num_samples.test=100 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=3 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=???


# v2
# zdim = 3 x,y,phi
# with SA-Mesh, from SA-Mesh ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.data_dir="/home/aminm/projects/rrg-bengioy-ad/aminm/output/3/cube_angle/v2" datamodule.start_idx.train=0 datamodule.num_samples.train=4000 datamodule.start_idx.valid=4000 datamodule.num_samples.valid=500 datamodule.start_idx.test=4500 datamodule.num_samples.test=500 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=3 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr","v2"] trainer.max_epochs=2000 ckpt_path=null model.pl_model_ckpt_path="/home/aminm/scratch/logs/training/runs/slot_attention_xyp_autoencoder_3_cyclic_fixed/2023-04-20_08-24-07/checkpoints/slot_attention_xyp_autoencoder_3_cyclic_fixed-epoch\=3324-train_loss\=0.000219-Linear_Disentanglement_regression\=0.07-Permutation_Disentanglement_regression\=0.27.ckpt"
# the above results in the following ckpt: "/home/aminm/scratch/logs/training/runs/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_3/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3/2023-04-20_18-12-13/checkpoints/SA_inertia_balls_contrastive_recons_zdim_3/n_balls_3/matching_False_cyclic_fixed_argmin_known_mech_True_sparsity_1_z_dis_3-epoch\=1954-train_loss\=0.01-Linear_Disentanglement\=0.96-Permutation_Disentanglement\=0.96.ckpt"
# with SA-Mesh, from full model ckpt
# python3 run_training.py model=inertia_balls_saae_contrastive_recons datamodule=sparse_clevr datamodule.start_idx.train=0 datamodule.num_samples.train=800 datamodule.start_idx.valid=800 datamodule.num_samples.valid=100 datamodule.start_idx.test=900 datamodule.num_samples.test=100 datamodule.dataset.z_dim=3 datamodule.dataset.properties_list=["x","y","p"] datamodule.n_balls=3 datamodule.batch_size=256 model.z_dim=3 model.disentangle_z_dim=3 model.encoder.slot_size=64 model.encoder.n_channels=4 model.optimizer.lr=0.0002 model.w_recons_loss=100.0 model.w_latent_loss=10.0 model.wait_steps=0 model.linear_steps=1 model.latent_matching="argmin" model.ball_matching=False model.double_matching=False model.known_mechanism=True model.known_action=True model.use_all_balls_mcc=False model.rm_background_in_matching=True model.pair_recons=True model.encoder_freeze=False model.additional_logger.logging_interval=400 callbacks=default ~model/scheduler_config ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["narval","disentanglement","no_matching","clevr"] trainer.max_epochs=2000 ckpt_path=???



deactivate
module purge
