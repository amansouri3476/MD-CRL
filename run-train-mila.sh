#!/bin/bash

#SBATCH --partition=long
#SBATCH --cpus-per-task=4
#SBATCH --mem=40G
#SBATCH --time=09:59:00
#SBATCH --output=./slurm_out/%j.out
#SBATCH --error=./slurm_err/%j.err

module load miniconda/3
conda activate mdcrl

export WANDB_API_KEY=1406ef3255ef2806f2ecc925a5e845e7164b5eef
wandb login

export LD_PRELOAD=/home/mila/s/sayed.mansouri-tehrani/MD-CRL/hack.so
# export WANDB_MODE=offline



# for runs more than a day, use: 1-11:59:00 (day-hour)


# -------------------------- Synthetic Mixing -------------------------- #


# python run_training.py ckpt_path=null model.optimizer.lr=0.01 model=mixing_synthetic datamodule=mixing ~callbacks.visualization_callback model.penalty_weight=0.00001
# python3 run_training.py model.additional_logger.logging_interval=400 ~callbacks.visualization_callback ~callbacks.early_stopping callbacks.model_checkpoint.monitor="train_loss" logger.wandb.tags=["mila"] ckpt_path=null trainer.max_epochs=2000


# python run_training.py ckpt_path=null model.optimizer.lr=0.001 datamodule/dataset=multi_domain_mnist model=default model.autoencoder.num_channels=3 model.z_dim=32
# python run_training.py ckpt_path=null model.optimizer.lr=0.001 datamodule/dataset=multi_domain_mnist model=multi_domain_autoencoder model.autoencoder.num_channels=3 model.z_dim=32
# python run_training.py ckpt_path=null model.optimizer.lr=0.001 datamodule/dataset=multi_domain_mnist model=default model.autoencoder.num_channels=3

# python run_training.py ckpt_path=null trainer.accelerator='gpu' trainer.devices=1 model/optimizer=adam model.optimizer.lr=0.001 model/scheduler_config=reduce_on_plateau model=mixing_synthetic model.penalty_criterion="minmax" model.hinge_loss_weight=0.0 datamodule=mixing datamodule.dataset.num_domains=4 datamodule.dataset.z_dim=8 ~callbacks.visualization_callback model.penalty_weight=1.0 logger.wandb.tags=["mila","test"]

# -------------------------- Linear Mixing -------------------------- #
# mmd
# python run_training.py ckpt_path=null model=mixing_synthetic datamodule=mixing datamodule.batch_size=1024 datamodule.dataset.linear=True datamodule.dataset.z_dim=4 datamodule.dataset.num_domains=8 ~callbacks.visualization_callback logger.wandb.tags=["mila","linear","mmd"] model.save_encoded_data=False

# -------------------------- Linear Mixing + Correlation -------------------------- #
# minmax
# python run_training.py ckpt_path=null model=mixing_synthetic model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=0. datamodule=mixing datamodule.batch_size=1024 datamodule.dataset.linear=True datamodule.dataset.z_dim=4 datamodule.dataset.num_domains=8 ~callbacks.visualization_callback logger.wandb.tags=["correlation"] model.save_encoded_data=False datamodule.dataset.correlated_z=True
# mmd
# python run_training.py ckpt_path=null model=mixing_synthetic model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=1. datamodule=mixing datamodule.batch_size=1024 datamodule.dataset.linear=True datamodule.dataset.z_dim=4 datamodule.dataset.num_domains=16 ~callbacks.visualization_callback logger.wandb.tags=["correlation"] model.save_encoded_data=False datamodule.dataset.correlated_z=True 
# python run_training.py ckpt_path=null model=mixing_synthetic model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=1. datamodule=mixing datamodule.batch_size=1024 datamodule.dataset.linear=True datamodule.dataset.z_dim=4 datamodule.dataset.num_domains=16 ~callbacks.visualization_callback logger.wandb.tags=["correlation"] model.save_encoded_data=False datamodule.dataset.correlated_z=True datamodule.dataset.corr_prob=1.0
# python run_training.py ckpt_path=null model=mixing_synthetic model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=1. datamodule=mixing datamodule.batch_size=1024 datamodule.dataset.linear=True datamodule.dataset.z_dim=4 datamodule.dataset.num_domains=16 ~callbacks.visualization_callback logger.wandb.tags=["correlation"] model.save_encoded_data=False datamodule.dataset.correlated_z=False

# ------------------------------------------------------------------------------------- #
# ----------------------- Polynomial Mixing, Non-Linear Model ------------------------- #
# ------------------------------------------------------------------------------------- #

# ------------------------------------------------------------------------------------- #
# ----------------------------------- Just reconstruction ----------------------------- #

# min-max penalty
# python run_training.py ckpt_path=null model=mixing_synthetic model/autoencoder=poly_ae model.optimizer.lr=0.001 datamodule=mixing datamodule.dataset.linear=False datamodule.dataset.non_linearity=polynomial datamodule.dataset.polynomial_degree=2 datamodule.batch_size=512 datamodule.dataset.z_dim=6 model.z_dim=6 datamodule.dataset.num_domains=8 datamodule.dataset.x_dim=200 ~callbacks.visualization_callback logger.wandb.tags=["mila","poly-mixing"]

# ----------------- Polynomial Mixing + Correlation | Reconstruction ------------------ #

# python run_training.py ckpt_path=null model=mixing_synthetic model/autoencoder=poly_ae model.penalty_criterion.minmax=0. model.penalty_criterion.mmd=0. datamodule=mixing datamodule.batch_size=1024 datamodule.dataset.linear=False datamodule.dataset.non_linearity=polynomial datamodule.dataset.polynomial_degree=2,3 datamodule.dataset.z_dim=6,8,10,12,14 datamodule.dataset.x_dim=200 datamodule.dataset.num_domains=16 ~callbacks.visualization_callback logger.wandb.tags=["correlation-poly-recons"] model.save_encoded_data=True datamodule.dataset.correlated_z=True datamodule.dataset.corr_prob=0.5 --multirun

# ------------------------------------------------------------------------------------- #
# ------------------------------------- Disentanglement ------------------------------- #
# min max penalty
# python run_training.py ckpt_path=null model=mixing_md_encoded_autoencoder model.optimizer.lr=0.001 datamodule=mixing_encoded datamodule.batch_size=512 ~callbacks.visualization_callback logger.wandb.tags=["mila","poly-mixing-disentanglement"] run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_synthetic_mixing_linear_False_8_6_p3/2023-09-25_18-42-34/"

# mmd penalty
# python run_training.py ckpt_path=null model=mixing_md_encoded_autoencoder model.optimizer.lr=0.001 datamodule=mixing_encoded datamodule.batch_size=1024 ~callbacks.visualization_callback logger.wandb.tags=["mila","poly-mixing-disentanglement","mmd"] model.penalty_criterion.mmd=1. model.penalty_criterion.minmax=0. run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_synthetic_mixing_linear_False_8_6_p3/2023-09-25_18-42-34/"

# ----------------- Polynomial Mixing + Correlation | Disentanglement ----------------- #
# minmax
# p2, d6
# python run_training.py ckpt_path=null model=mixing_md_encoded_autoencoder datamodule=mixing_encoded model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=0. datamodule.batch_size=1024 ~callbacks.visualization_callback logger.wandb.tags=["poly-dis-corr"] run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_synthetic_mixing_linear_False_16_6_p2/2023-10-08_05-41-38/datamodule.dataset.polynomial_degree=2,datamodule.dataset.z_dim=6,model/autoencoder=poly_ae,model=mixing_synthetic/'"
# p3, d6
# python run_training.py ckpt_path=null model=mixing_md_encoded_autoencoder datamodule=mixing_encoded model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=0. datamodule.batch_size=1024 ~callbacks.visualization_callback logger.wandb.tags=["poly-dis-corr"] run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_synthetic_mixing_linear_False_16_6_p3/2023-10-08_05-41-38/datamodule.dataset.polynomial_degree=3,datamodule.dataset.z_dim=6,model/autoencoder=poly_ae,model=mixing_synthetic/'"
# p2, d8
# python run_training.py ckpt_path=null model=mixing_md_encoded_autoencoder datamodule=mixing_encoded model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=0. datamodule.batch_size=1024 ~callbacks.visualization_callback logger.wandb.tags=["poly-dis-corr"] run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_synthetic_mixing_linear_False_16_8_p2/2023-10-08_05-41-38/datamodule.dataset.polynomial_degree=2,datamodule.dataset.z_dim=8,model/autoencoder=poly_ae,model=mixing_synthetic/'"
# p3, d8
# python run_training.py ckpt_path=null model=mixing_md_encoded_autoencoder datamodule=mixing_encoded model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=0. datamodule.batch_size=1024 ~callbacks.visualization_callback logger.wandb.tags=["poly-dis-corr"] run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_synthetic_mixing_linear_False_16_8_p3/2023-10-08_05-41-38/datamodule.dataset.polynomial_degree=3,datamodule.dataset.z_dim=8,model/autoencoder=poly_ae,model=mixing_synthetic/'"
# p2, d10
# python run_training.py ckpt_path=null model=mixing_md_encoded_autoencoder datamodule=mixing_encoded model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=0. datamodule.batch_size=1024 ~callbacks.visualization_callback logger.wandb.tags=["poly-dis-corr"] run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_synthetic_mixing_linear_False_16_10_p2/2023-10-08_05-41-38/datamodule.dataset.polynomial_degree=2,datamodule.dataset.z_dim=10,model/autoencoder=poly_ae,model=mixing_synthetic/'"
# p3, d10
# python run_training.py ckpt_path=null model=mixing_md_encoded_autoencoder datamodule=mixing_encoded model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=0. datamodule.batch_size=1024 ~callbacks.visualization_callback logger.wandb.tags=["poly-dis-corr"] run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_synthetic_mixing_linear_False_16_10_p3/2023-10-08_05-41-38/datamodule.dataset.polynomial_degree=3,datamodule.dataset.z_dim=10,model/autoencoder=poly_ae,model=mixing_synthetic/'"
# p2, d12
# python run_training.py ckpt_path=null model=mixing_md_encoded_autoencoder datamodule=mixing_encoded model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=0. datamodule.batch_size=1024 ~callbacks.visualization_callback logger.wandb.tags=["poly-dis-corr"] run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_synthetic_mixing_linear_False_16_12_p2/2023-10-08_05-41-38/datamodule.dataset.polynomial_degree=2,datamodule.dataset.z_dim=12,model/autoencoder=poly_ae,model=mixing_synthetic/'"
# p3, d12
# python run_training.py ckpt_path=null model=mixing_md_encoded_autoencoder datamodule=mixing_encoded model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=0. datamodule.batch_size=1024 ~callbacks.visualization_callback logger.wandb.tags=["poly-dis-corr"] run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_synthetic_mixing_linear_False_16_12_p3/2023-10-08_05-41-38/datamodule.dataset.polynomial_degree=3,datamodule.dataset.z_dim=12,model/autoencoder=poly_ae,model=mixing_synthetic/'"
# p2, d14
# python run_training.py ckpt_path=null model=mixing_md_encoded_autoencoder datamodule=mixing_encoded model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=0. datamodule.batch_size=1024 ~callbacks.visualization_callback logger.wandb.tags=["poly-dis-corr"] run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_synthetic_mixing_linear_False_16_14_p2/2023-10-08_05-41-38/datamodule.dataset.polynomial_degree=2,datamodule.dataset.z_dim=14,model/autoencoder=poly_ae,model=mixing_synthetic/'"
# p3, d14
python run_training.py ckpt_path=null model=mixing_md_encoded_autoencoder datamodule=mixing_encoded model.penalty_criterion.minmax=1. model.penalty_criterion.mmd=0. datamodule.batch_size=1024 ~callbacks.visualization_callback logger.wandb.tags=["poly-dis-corr"] run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_synthetic_mixing_linear_False_16_14_p3/2023-10-08_05-41-38/datamodule.dataset.polynomial_degree=3,datamodule.dataset.z_dim=14,model/autoencoder=poly_ae,model=mixing_synthetic/'"


# mmd


# ------------------------------------------------------------------------------------- #
# --------------------------------------- Balls --------------------------------------- #
# ------------------------------------------------------------------------------------- #

# ------------------------------------------------------------------------------------- #
# -------------------------------- Reconstruction Only -------------------------------- #


# cnn with conv and upsampling
# python run_training.py trainer.accelerator='gpu' trainer.devices=1 ckpt_path=null model/optimizer=adamw model.optimizer.lr=0.001 datamodule=md_balls model=balls model.z_dim=64 model/autoencoder=cnn_ae_balls model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","balls","cnn"] ~callbacks.early_stopping

# resnet18
# python run_training.py trainer.accelerator='gpu' trainer.devices=1 ckpt_path=null model/optimizer=adamw model.optimizer.lr=0.001 datamodule=md_balls model=balls model.z_dim=25 model/autoencoder=resnet18_ae_balls model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","balls","resnet"] ~callbacks.early_stopping

# non-overlapping dataset
# python run_training.py trainer.accelerator='gpu' trainer.devices="auto" ckpt_path=null model.optimizer.lr=0.001 datamodule=md_balls model=balls model.z_dim=128 model/autoencoder=resnet18_ae_balls logger.wandb.tags=["test"] ~callbacks.early_stopping datamodule.data_dir="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-05_06-20-54/"

# python run_training.py trainer.accelerator='cpu' ckpt_path=null model/optimizer=adamw model.optimizer.lr=0.001 datamodule=md_balls model=balls model.z_dim=64 model/autoencoder=resnet18_ae_balls model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","balls","test"] ~callbacks.early_stopping

# ------------------------- Reconstruction Only + Correlation ------------------------- #

# ----------------------------- Systematic Sweep (Stage 2) ---------------------------- #
# resnet18 64 bn-enc
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-2","res-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path=/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_64_iv_1_sp_1/2023-10-01_18-15-26/ model.z_dim=64 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2,0.5,0.8 model/autoencoder=linear_ae_synthetic,mlp_ae_balls model.loss_transform="mse","l1" ckpt_path=null --multirun
# resnet18 64 bn-ae
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-2","res-bn-ae"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path=/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_64_iv_1_sp_1/2023-10-01_18-03-25/ model.z_dim=64 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2,0.5,0.8 model/autoencoder=linear_ae_synthetic,mlp_ae_balls model.loss_transform="mse","l1" ckpt_path=null --multirun
# resnet18 128 bn-enc
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-2","res-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path=/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-01_18-15-26/ model.z_dim=128 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2,0.5,0.8 model/autoencoder=linear_ae_synthetic,mlp_ae_balls model.loss_transform="mse","l1" ckpt_path=null --multirun
# cnn 64 bn-enc
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-2","cnn-up-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path=/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_64_iv_1_sp_1/2023-10-01_18-06-25/ model.z_dim=64 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2,0.5,0.8 model/autoencoder=linear_ae_synthetic,mlp_ae_balls model.loss_transform="mse","l1" ckpt_path=null --multirun
# cnn 128 bn-enc
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-2","cnn-up-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path=/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-01_18-06-25/ model.z_dim=128 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2,0.5,0.8 model/autoencoder=linear_ae_synthetic,mlp_ae_balls model.loss_transform="mse","l1" ckpt_path=null --multirun

# ----------------------------- Systematic Sweep (Stage 3) ---------------------------- #
# supervised MLP training; for each of the above sweeps, there are 24 runs, we should get their run_path and run them with the following command (adapting the zhat_inv dimension)
# 0.2 * 64 = 12, 0.5 * 64 = 32, 0.8 * 64 = 51 | 0.2 * 128 = 25, 0.5 * 128 = 64, 0.8 * 128 = 102

# resnet18 64 bn-enc
# f = 0.2
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","res-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=64 model.zhat_dim_inv=12 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'" --multirun
# f = 0.5
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","res-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=64 model.zhat_dim_inv=32 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun
# f = 0.8
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","res-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=64 model.zhat_dim_inv=51 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-46-56/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun


# resnet18 64 bn-ae
# f = 0.2
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","res-bn-ae"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=64 model.zhat_dim_inv=12 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun
# f = 0.5
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","res-bn-ae"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=64 model.zhat_dim_inv=32 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun
# f = 0.8
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","res-bn-ae"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=64 model.zhat_dim_inv=51 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_13-48-10/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun


# cnn 64 bn-enc
# f = 0.2
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","cnn-up-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=64 model.zhat_dim_inv=12 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun
# f = 0.5
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","cnn-up-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=64 model.zhat_dim_inv=32 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun
# f = 0.8
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","cnn-up-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=64 model.zhat_dim_inv=51 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_64/2023-10-02_16-28-17/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=64,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun


# resnet18 128 bn-enc
# f = 0.2
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","res-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=128 model.zhat_dim_inv=25 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun
# f = 0.5
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","res-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=128 model.zhat_dim_inv=64 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun
# f = 0.8
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","res-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=128 model.zhat_dim_inv=102 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-14-15/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun



# cnn 128 bn-enc
# f = 0.2
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","cnn-up-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=128 model.zhat_dim_inv=25 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.2,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun
# f = 0.5
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","cnn-up-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=128 model.zhat_dim_inv=64 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.5,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun
# f = 0.8
# python run_training.py trainer.accelerator="cpu" ckpt_path=null trainer.devices="auto" model.optimizer.lr=0.001 datamodule=xz datamodule.batch_size=1024 model=xz model.hidden_size=500 model.n_layers=5 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","systematic-sweep-3","cnn-up-bn-enc"] ~callbacks.early_stopping ~callbacks.visualization_callback ~trainer.gradient_clip_val model.zhat_dim=128 model.zhat_dim_inv=102 run_path="'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.0,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.0,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.01,model.loss_transform=mse,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=linear_ae_synthetic,model=balls_md_encoded_autoencoder'","'/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/multiruns/autoencoder_balls_encoded_128/2023-10-02_16-30-14/model.hinge_loss_weight=0.01,model.loss_transform=l1,model.optimizer.lr=0.001,model.penalty_weight=1.0,model.z_dim=128,model.z_dim_invariant_fraction=0.8,model/autoencoder=mlp_ae_balls,model=balls_md_encoded_autoencoder'" --multirun

# ------------------------------------------------------------------------------------- #
# -------------------------- Disentanglement with encoded images ---------------------- #

# -------------------------- min-max penalty, no hinge loss ---------------------- #

# iv=1,sp=1
# cpu
# python run_training.py ckpt_path=null trainer.accelerator='cpu' model.optimizer.lr=0.001 datamodule=balls_encoded model=balls_md_encoded_autoencoder model.z_dim=4 model.z_dim_invariant_fraction=0.5 model.hinge_loss_weight=0.0 model.penalty_criterion="minmax" model.penalty_weight=1.0 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["narval","balls-encoded"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/aminm/scratch/logs/training/runs/autoencoder_md_balls_64_iv_1_sp_1/2023-09-16_08-23-15" ckpt_path=null
# python run_training.py ckpt_path=null trainer.gradient_clip_val=0.1 trainer.accelerator='cpu' model.optimizer.lr=0.001 datamodule=balls_encoded model=balls_md_encoded_autoencoder model.z_dim=4 model.z_dim_invariant_fraction=0.5 model.hinge_loss_weight=0.0 model.penalty_criterion="minmax" model.penalty_weight=1.0 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["narval","balls-encoded"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_64_iv_1_sp_1/2023-09-19_07-33-06" ckpt_path=null

# resnet18 128 bn-enc non-overlapping dataset
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=10.0 logger.wandb.tags=["mila","non-overlap","val"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-05_07-21-05/" model.z_dim=128 model.hinge_loss_weight=0.0 model.z_dim_invariant_fraction=0.5,0.8 model/autoencoder=linear_ae_synthetic,mlp_ae_balls ckpt_path=null model.penalty_criterion.mmd=1. model.penalty_criterion.minmax=0. model.mmd_loss.kernel_multiplier=1.0,2.0 model.mmd_loss.kernel_number=1,3 model.mmd_loss.fix_sigma=1.0,null --multirun
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 logger.wandb.tags=["mila","non-overlap","mmd"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-05_07-21-05/" model.z_dim=128 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2 model/autoencoder=mlp_ae_balls ckpt_path=null model.penalty_criterion.mmd=1. model.penalty_criterion.minmax=0. model.mmd_loss.kernel_multiplier=1.0,3.0 model.mmd_loss.kernel_number=1,3 model.mmd_loss.fix_sigma=1.0,null model.save_encoded_data=False --multirun
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 logger.wandb.tags=["mila","non-overlap","minmax"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-05_07-21-05/" model.z_dim=128 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2 model/autoencoder=mlp_ae_balls ckpt_path=null model.penalty_criterion.mmd=0. model.penalty_criterion.minmax=1. model.save_encoded_data=False model.top_k=5,10 --multirun
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 logger.wandb.tags=["mila","non-overlap","minmax-mmd"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-05_07-21-05/" model.z_dim=128 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2 model/autoencoder=mlp_ae_balls ckpt_path=null model.penalty_criterion.mmd=1. model.penalty_criterion.minmax=1. model.mmd_loss.kernel_multiplier=1.0 model.mmd_loss.kernel_number=1 model.mmd_loss.fix_sigma=1.0,null model.save_encoded_data=False --multirun

# default values, sanity check, mmd-minmax
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 logger.wandb.tags=["default-sanity-check-balls","minmax-mmd"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-05_07-21-05/" model.z_dim=128 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2,0.5,0.8 model/autoencoder=mlp_ae_balls ckpt_path=null model.penalty_criterion.mmd=1. model.penalty_criterion.minmax=1. model.mmd_loss.kernel_multiplier=1.0 model.mmd_loss.kernel_number=1 model.mmd_loss.fix_sigma=1.0 model.save_encoded_data=False seed=1234,4586,82912 --multirun
# default values, sanity check, mmd
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 logger.wandb.tags=["default-sanity-check-balls","mmd"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-05_07-21-05/" model.z_dim=128 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2,0.5,0.8 model/autoencoder=mlp_ae_balls ckpt_path=null model.penalty_criterion.mmd=1. model.penalty_criterion.minmax=0. model.mmd_loss.kernel_multiplier=1.0 model.mmd_loss.kernel_number=1 model.mmd_loss.fix_sigma=1.0 model.save_encoded_data=False seed=1234,4586,82912 --multirun
# default values, sanity check, minmax
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 logger.wandb.tags=["default-sanity-check-balls","minmax"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-05_07-21-05/" model.z_dim=128 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2,0.5,0.8 model/autoencoder=mlp_ae_balls ckpt_path=null model.penalty_criterion.mmd=0. model.penalty_criterion.minmax=1. model.top_k=5,10 model.save_encoded_data=False seed=1234,4586,82912 --multirun

# original dataset
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 logger.wandb.tags=["mila","overlap","mmd"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-01_18-15-26/" model.z_dim=128 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2,0.5,0.8 model/autoencoder=mlp_ae_balls ckpt_path=null model.penalty_criterion.mmd=1. model.penalty_criterion.minmax=0. model.mmd_loss.kernel_multiplier=1.0,3.0 model.mmd_loss.kernel_number=1,3 model.mmd_loss.fix_sigma=1.0,null model.save_encoded_data=False --multirun
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 logger.wandb.tags=["mila","overlap","minmax"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-01_18-15-26/" model.z_dim=128 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2,0.5,0.8 model/autoencoder=mlp_ae_balls ckpt_path=null model.penalty_criterion.mmd=0. model.penalty_criterion.minmax=1. model.save_encoded_data=False model.top_k=5,10 --multirun
# python run_training.py trainer.accelerator="cpu" trainer.devices="auto" model.optimizer.lr=0.001 datamodule=balls_encoded datamodule.batch_size=1024 model=balls_md_encoded_autoencoder model.penalty_weight=1.0 logger.wandb.tags=["mila","overlap","minmax-mmd"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-01_18-15-26/" model.z_dim=128 model.hinge_loss_weight=0.0,0.01 model.z_dim_invariant_fraction=0.2,0.5,0.8 model/autoencoder=mlp_ae_balls ckpt_path=null model.penalty_criterion.mmd=1. model.penalty_criterion.minmax=1. model.mmd_loss.kernel_multiplier=1.0 model.mmd_loss.kernel_number=1 model.mmd_loss.fix_sigma=1.0,null model.save_encoded_data=False --multirun

# ---------------------------- mmd penalty, no hinge loss ------------------------ #
# 64
# python run_training.py trainer.accelerator='cpu' model.optimizer.lr=0.001 datamodule=balls_encoded model=balls_md_encoded_autoencoder model.z_dim=64 model.z_dim_invariant_fraction=0.5 model.penalty_criterion.mmd=1. model.penalty_criterion.minmax=0. model.hinge_loss_weight=0.0 model.penalty_weight=1.0 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","balls-encoded","mmd"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_64_iv_1_sp_1/2023-10-01_18-15-26/" ckpt_path=null

# 128
# python run_training.py trainer.accelerator='cpu' model.optimizer.lr=0.001 datamodule=balls_encoded model=balls_md_encoded_autoencoder model.z_dim=128 model.z_dim_invariant_fraction=0.5 model.penalty_criterion.mmd=1. model.penalty_criterion.minmax=0. model.hinge_loss_weight=0.0 model.penalty_weight=10.0 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","balls-encoded","mmd"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-01_18-03-28/" ckpt_path=null model/autoencoder=linear_ae_synthetic

# python run_training.py trainer.accelerator='cpu' model.optimizer.lr=0.001 datamodule=balls_encoded model=balls_md_encoded_autoencoder model.z_dim=128 model.z_dim_invariant_fraction=0.8 model.penalty_criterion.mmd=1. model.penalty_criterion.minmax=0. model.hinge_loss_weight=0.0 model.penalty_weight=10.0 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","balls-encoded","mmd"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-01_18-06-25/" ckpt_path=null model.mmd_loss.fix_sigma=1.0 

# python run_training.py trainer.accelerator='cpu' model.optimizer.lr=0.001 datamodule=balls_encoded model=balls_md_encoded_autoencoder model.z_dim=128 model.z_dim_invariant_fraction=0.1,0.5,0.9 model.penalty_criterion.mmd=1. model.mmd_loss.kernel_multiplier=1.0,2.0 model.mmd_loss.kernel_number=1,3 model.mmd_loss.fix_sigma=1.0,null model.penalty_criterion.minmax=0. model.hinge_loss_weight=0.0 model.penalty_weight=0.01,0.1 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","sweep-mmd"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_md_balls_128_iv_1_sp_1/2023-10-01_18-15-26/" ckpt_path=null model/autoencoder=linear_ae_synthetic,mlp_ae_balls datamodule.batch_size=1024 datamodule.dataset.normalize=True --multirun

# ------------------------------------------------------------------------------------- #
# --------------------------------------- MNIST --------------------------------------- #
# ------------------------------------------------------------------------------------- #

# ------------------------------------------------------------------------------------- #
# -------------------------- Disentanglement with encoded images ---------------------- #
# python run_training.py trainer.gpus=0 ckpt_path=null model.optimizer.lr=0.001 datamodule=mnist_encoded model=mnist_md_encoded_autoencoder model/autoencoder=mlp_ae_mnist_nc model.z_dim=256 model.z_dim_invariant_fraction=0.9 model.hinge_loss_weight=0.0 model.penalty_criterion="minmax" model.penalty_weight=1.0 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","log"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_multi_domain_mnist_8_256/2023-09-09_07-59-59"
# python run_training.py ckpt_path=null model.optimizer.lr=0.001 datamodule=mnist_encoded model=mnist_md_encoded_autoencoder model.z_dim=256 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","mnist","separate"] ~callbacks.early_stopping ~callbacks.visualization_callback trainer.gpus=1 run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_multi_domain_mnist_8_256/2023-09-09_07-59-59"

# python run_training.py trainer.accelerator='gpu' trainer.devices=1 ckpt_path=null model.optimizer.lr=0.001 datamodule=mnist_encoded model=mnist_md_encoded_autoencoder model/autoencoder=mlp_ae_mnist_nc model.z_dim=256 model.z_dim_invariant_fraction=0.9 model.hinge_loss_weight=0.0 model.penalty_criterion="minmax" model.penalty_weight=1.0 model/scheduler_config=reduce_on_plateau model.scheduler_config.scheduler_dict.monitor="train_loss" logger.wandb.tags=["mila","log"] ~callbacks.early_stopping ~callbacks.visualization_callback run_path="/home/mila/s/sayed.mansouri-tehrani/scratch/logs/training/runs/autoencoder_multi_domain_mnist_8_256/2023-09-09_07-59-59"

conda deactivate
module purge
